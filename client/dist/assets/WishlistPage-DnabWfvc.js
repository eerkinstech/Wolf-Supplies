import{j as e}from"./editor-BiSlXHWs.js";import{a as o,R as r,L as t}from"./vendor-0z5P9xg-.js";import{u as s,d as a}from"./redux-DhaBhdiE.js";import{o as l,p as c,z as i,d as n,e as d,r as m}from"./index-BiO51Ilc.js";import{P as p}from"./ProductCard-B1CLfHgm.js";const u=()=>{const u=s(),h=a(e=>e.wishlist.items),[x,g]=o.useState("newest"),v=e=>{return e?e.slug?e.slug:e.product&&e.product.slug?e.product.slug:e.snapshot&&e.snapshot.slug?e.snapshot.slug:e.name?(o=e.name,String(o||"").toLowerCase().trim().replace(/\s+/g,"-").replace(/[^a-z0-9-]/g,"").replace(/-+/g,"-")):"":"";var o},b=a(e=>e.cart.items),f=e=>{if(!e)return null;const o=e.product&&(e.product._id||e.product)||e.productId||e.snapshot?.productId||e._id||"",r=e.variantId||e.snapshot&&e.snapshot.variantId||"",t="string"==typeof o&&o.includes("|")?o.split("|")[0]:o,s="string"==typeof t&&/^[0-9a-fA-F]{24}$/.test(t)?t:"",a=e.selectedVariants||e.snapshot?.selectedVariants||{};e.selectedSize&&(a.Size=e.selectedSize),e.selectedColor&&(a.Color=e.selectedColor);return{_id:r?`${s||"unknown"}|variant:${r}`:`${s||"unknown"}`,product:s||void 0,name:e.name||e.product&&e.product.name||"",price:Number(e.price??e.snapshot?.price??(e.product&&e.product.price)??0),image:e.image||e.snapshot?.image||e.product&&(e.product.image||e.product.images&&e.product.images[0])||"",quantity:1,selectedVariants:a||{}}},y=e=>{if(!e)return!0;if(e.__isSnapshot){const o=e.product||null;if(o&&o.variantCombinations&&e.variantId){const r=o.variantCombinations.find(o=>String(o._id||o.id)===String(e.variantId));if(r)return Number(r.stock||0)>0}if(o&&o.variantCombinations){const r={...e.selectedVariants||{}};e.selectedSize&&(r.Size=e.selectedSize),e.selectedColor&&(r.Color=e.selectedColor);for(const e of o.variantCombinations){const o=e.variantValues||{},t=o instanceof Map?Object.fromEntries(o):o,s=Object.keys(t);let a=!0;for(const e of s){const o=t[e],s=r[e];if(void 0!==o&&(void 0===s||String(s)!==String(o))){a=!1;break}}if(a)return Number(e.stock||0)>0}}return void 0!==e.inStock?!!e.inStock:void 0===e.stock||Number(e.stock)>0}return e.variantCombinations&&e.variantCombinations.length>0?void 0!==e.stock?Number(e.stock)>0:void 0===e.inStock||!!e.inStock:void 0!==e.inStock?!!e.inStock:void 0===e.stock||Number(e.stock)>0},j=e=>{if("string"==typeof e)u(m(e)).then(()=>{i.success("Removed from wishlist")}).catch(e=>{i.error("Failed to remove from wishlist")});else if(e&&"object"==typeof e){let o=null;o=e.__isSnapshot?e._id:e.productId||e._id||e.product&&(e.product._id||e.product);const r=e.variantId||e.snapshot&&e.snapshot.variantId||null;u(m({productId:o,variantId:r})).then(()=>{i.success("Removed from wishlist")}).catch(e=>{i.error("Failed to remove from wishlist")})}};r.useEffect(()=>{localStorage.getItem("token")&&u(l())},[u]),r.useEffect(()=>{h.forEach((e,o)=>{})},[h]);const N=(()=>{let e=[...h];return"priceLow"===x?e.sort((e,o)=>e.price-o.price):"priceHigh"===x?e.sort((e,o)=>o.price-e.price):"name"===x&&e.sort((e,o)=>e.name.localeCompare(o.name)),e})();return e.jsxs("div",{className:"min-h-screen",style:{backgroundColor:"var(--color-bg-primary)"},children:[e.jsx("div",{className:"text-white py-12 md:py-16",style:{backgroundColor:"var(--color-accent-primary)"},children:e.jsxs("div",{className:"max-w-6xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsxs(t,{to:"/",className:"flex items-center gap-2 mb-6 hover:opacity-80 w-fit",children:[e.jsx("i",{className:"fas fa-arrow-left"})," Back to Home"]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("i",{className:"fas fa-heart",style:{fontSize:"32px"}}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-5xl md:text-6xl font-bold",children:"My Wishlist"}),e.jsxs("p",{className:"text-xl mt-2",children:[h.length," ",1===h.length?"item":"items"," saved"]})]})]})]})}),e.jsx("div",{className:"max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 py-12",children:0===h.length?e.jsxs("div",{className:"text-center py-16",children:[e.jsx("div",{className:"inline-block",children:e.jsx("div",{className:"text-8xl mb-6 opacity-50",children:"ðŸ’”"})}),e.jsx("h2",{className:"text-3xl font-bold mb-4",style:{color:"var(--color-text-primary)"},children:"Your Wishlist is Empty"}),e.jsx("p",{className:"text-lg mb-8",style:{color:"var(--color-text-light)"},children:"Start adding products to your wishlist and save them for later!"}),e.jsx(t,{to:"/products",className:"inline-block text-white px-8 py-3 rounded-lg font-bold transition duration-300",style:{backgroundColor:"var(--color-accent-primary)"},onMouseEnter:e=>e.target.style.backgroundColor="var(--color-accent-light)",onMouseLeave:e=>e.target.style.backgroundColor="var(--color-accent-primary)",children:"Browse Products"})]}):e.jsxs("div",{className:"grid lg:grid-cols-4 gap-8",children:[e.jsxs("div",{className:"lg:col-span-3",children:[e.jsx("div",{className:"rounded-lg shadow-md p-6 mb-8",style:{backgroundColor:"var(--color-bg-primary)",borderColor:"var(--color-border-light)",borderWidth:"1px"},children:e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-semibold",style:{color:"var(--color-text-primary)"},children:"Sort by:"}),e.jsxs("select",{value:x,onChange:e=>g(e.target.value),className:"px-4 py-2 rounded-lg focus:outline-none focus:ring-2",style:{borderColor:"var(--color-border-light)",borderWidth:"1px",color:"var(--color-text-primary)"},onFocus:e=>(e.target.style.outline="none",e.target.style.ringColor="var(--color-accent-primary)"),children:[e.jsx("option",{value:"newest",children:"Newest"}),e.jsx("option",{value:"priceLow",children:"Price: Low to High"}),e.jsx("option",{value:"priceHigh",children:"Price: High to Low"}),e.jsx("option",{value:"name",children:"Name: A to Z"})]})]}),e.jsxs("button",{onClick:()=>{if(h.length>0){window.confirm("Are you sure you want to clear your entire wishlist?")&&u(c()).then(()=>{i.success("Wishlist cleared")}).catch(e=>{i.error("Failed to clear wishlist")})}},className:"font-semibold flex items-center gap-2 transition duration-300",style:{color:"var(--color-accent-primary)"},onMouseEnter:e=>e.target.style.opacity="0.8",onMouseLeave:e=>e.target.style.opacity="1",children:[e.jsx("i",{className:"fas fa-trash"})," Clear All"]})]})}),e.jsx("div",{className:"space-y-6",children:N.map(o=>{return y(o),e.jsx("div",{className:"relative rounded-lg shadow-md hover:shadow-xl transition duration-300 overflow-hidden",style:{backgroundColor:"var(--color-bg-primary)",borderColor:"var(--color-border-light)",borderWidth:"1px"},children:o.__isSnapshot?e.jsxs("div",{className:"flex items-stretch md:items-start",children:[e.jsx("div",{className:"w-36 shrink-0 overflow-hidden",style:{backgroundColor:"var(--color-bg-section)"},children:e.jsx("img",{src:(r=o.image,(r?"string"!=typeof r?"":r.startsWith("http")?r:`https://api.wolfsupplies.co.uk${r}`:"")||"https://via.placeholder.com/300"),alt:o.name,className:"w-full h-full object-cover",onError:e=>{e.target.src="https://via.placeholder.com/300"}})}),e.jsxs("div",{className:"p-4 flex-1 flex flex-col",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx(t,{to:`/product/${v(o)}`,className:"hover:underline",children:e.jsx("h3",{className:"text-lg font-bold",style:{color:"var(--color-text-primary)"},children:o.name})}),e.jsx("div",{className:"mt-1 text-sm",style:{color:"var(--color-text-secondary)"},children:Object.entries(o.selectedVariants||{}).map(([e,o])=>`${e}: ${o}`).join(", ")})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-xl font-bold",style:{color:"var(--color-accent-primary)"},children:["Â£",(o.price||0).toFixed(2)]}),e.jsx("div",{className:"text-sm",style:{color:"var(--color-text-secondary)"},children:"Variant"})]})]}),e.jsxs("div",{className:"mt-4 flex gap-3",children:[!y(o)&&e.jsx("div",{className:"absolute top-3 left-3 text-white px-2 py-1 rounded text-xs font-bold",style:{backgroundColor:"var(--color-accent-primary)"},children:"Out of stock"}),y(o)?e.jsxs("button",{onClick:()=>(e=>{if(!y(e))return void i.error("This item is out of stock and cannot be added to cart");const o=f(e);if(!o)return;u(n(o));const r=[...b||[],o];u(d(r)),i.success("Added to cart")})(o),className:"py-2 px-4 rounded-lg font-semibold transition duration-300 flex items-center gap-2 text-white",style:{backgroundColor:"var(--color-accent-primary)"},onMouseEnter:e=>e.target.style.backgroundColor="var(--color-accent-light)",onMouseLeave:e=>e.target.style.backgroundColor="var(--color-accent-primary)",children:[e.jsx("i",{className:"fas fa-shopping-cart"})," Add to Cart"]}):e.jsx("button",{disabled:!0,className:"py-2 px-4 rounded-lg font-semibold transition duration-300 flex items-center gap-2 text-white cursor-not-allowed",style:{backgroundColor:"var(--color-text-light)",opacity:"0.6"},children:"Sold Out"}),e.jsxs("button",{onClick:()=>j(o),className:"py-2 px-4 rounded-lg font-semibold transition duration-300 flex items-center gap-2",style:{backgroundColor:"var(--color-bg-section)",color:"var(--color-accent-primary)",borderColor:"var(--color-border-light)",borderWidth:"1px"},onMouseEnter:e=>e.target.style.backgroundColor="var(--color-border-light)",onMouseLeave:e=>e.target.style.backgroundColor="var(--color-bg-section)",children:[e.jsx("i",{className:"fas fa-trash"})," Remove"]}),e.jsx(t,{to:`/product/${v(o)}`,className:"ml-auto inline-flex items-center justify-center gap-2 rounded-lg px-3 py-2",style:{borderColor:"var(--color-border-light)",borderWidth:"1px",color:"var(--color-text-primary)"},onMouseEnter:e=>e.target.style.backgroundColor="var(--color-bg-section)",onMouseLeave:e=>e.target.style.backgroundColor="transparent",children:"View Product"})]})]})]}):e.jsxs("div",{className:"relative",children:[e.jsx(p,{product:o}),e.jsx("button",{onClick:e=>{e.preventDefault(),e.stopPropagation(),j(o)},className:"absolute top-3 right-3 z-50 p-2 rounded-full shadow transition duration-300",style:{backgroundColor:"white",color:"var(--color-accent-primary)"},onMouseEnter:e=>e.target.style.backgroundColor="var(--color-bg-section)",onMouseLeave:e=>e.target.style.backgroundColor="white","aria-label":`Remove ${o.name} from wishlist`,children:e.jsx("i",{className:"fas fa-trash"})})]})},(o.productId||o._id)+(o.variantId?`-${o.variantId}`:""));var r})})]}),e.jsx("div",{className:"lg:col-span-1",children:e.jsxs("aside",{className:"rounded-lg shadow-lg p-6 sticky top-24",style:{backgroundColor:"var(--color-bg-section)",borderColor:"var(--color-border-light)",borderWidth:"1px"},children:[e.jsx("h2",{className:"text-2xl font-bold mb-4",style:{color:"var(--color-text-primary)"},children:"Wishlist Summary"}),e.jsxs("div",{className:"mb-6 grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"col-span-1",children:[e.jsx("p",{className:"text-sm",style:{color:"var(--color-text-secondary)"},children:"Items"}),e.jsx("p",{className:"text-3xl font-extrabold",style:{color:"var(--color-accent-primary)"},children:h.length})]}),e.jsxs("div",{className:"col-span-1 text-right",children:[e.jsx("p",{className:"text-sm",style:{color:"var(--color-text-secondary)"},children:"Â "}),e.jsx("p",{className:"text-2xl font-bold",style:{color:"var(--color-text-primary)"},children:"Â "})]})]}),e.jsx("div",{className:"mb-4",children:e.jsxs("button",{onClick:()=>{const e=[],o=[];for(const s of h){y(s)?e.push(s):o.push(s)}if(0===e.length)return void i.error("No available items to move to cart");const r=[];e.forEach(e=>{const o=f(e);o&&(r.push(o),u(n(o)))});const t=[...b||[],...r];u(d(t)),e.forEach(e=>{const o=e.productId||e._id||e.product&&(e.product._id||e.product),r=e.variantId||null;u(m({productId:o,variantId:r}))}),i.success(`Moved ${e.length} item(s) to cart${o.length?` â€” ${o.length} out-of-stock skipped`:""}`)},disabled:0===h.filter(y).length,className:"w-full text-white py-3 px-4 rounded-lg font-bold transition duration-300 disabled:opacity-60 disabled:cursor-not-allowed flex items-center justify-center gap-2",style:{backgroundColor:"var(--color-accent-primary)"},onMouseEnter:e=>!e.target.disabled&&(e.target.style.backgroundColor="var(--color-accent-light)"),onMouseLeave:e=>e.target.style.backgroundColor="var(--color-accent-primary)",children:[e.jsx("i",{className:"fas fa-shopping-cart"})," Move All to Cart"]})}),e.jsx("div",{className:"flex gap-3 mb-4",children:e.jsx(t,{to:"/products",className:"flex-1 inline-flex items-center bg-white justify-center gap-2 rounded-lg px-3 py-2",style:{borderColor:"var(--color-border-light)",borderWidth:"1px",color:"var(--color-text-primary)"},onMouseEnter:e=>e.target.style.backgroundColor="var(--color-bg-secondary)",onMouseLeave:e=>e.target.style.backgroundColor="white",children:"Continue Shopping"})})]})})]})})]})};export{u as default};
