import{j as e}from"./editor-BiSlXHWs.js";import{a as r,u as o,L as t}from"./vendor-0z5P9xg-.js";import{u as s,d as a}from"./redux-DhaBhdiE.js";import{u as l,k as c,z as n,l as i,m as d,e as m,n as x}from"./index-BiO51Ilc.js";import{R as p}from"./RelatedProducts-DNGsb14a.js";import"./ProductCard-B1CLfHgm.js";const y="https://api.wolfsupplies.co.uk",u=e=>{if(!e)return null;if(Array.isArray(e)){const r=e.find(e=>!!e);return u(r)}if("object"==typeof e){const r=e.url||e.secure_url||e.path||e.src||e.public_id||e.location;return r&&"string"==typeof r?r.startsWith("http")?r:`${y}${r}`:null}return"string"==typeof e?e.startsWith("http")?e:`${y}${e}`:null},h=({item:r,onRemove:o,onUpdateQuantity:t,index:s,isLast:a})=>e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"p-6 sm:p-8 transition duration-300",style:{backgroundColor:"var(--color-bg-primary)"},children:[e.jsxs("div",{className:"flex flex-col sm:flex-row gap-6 mb-4",children:[e.jsx("div",{className:"relative w-32 h-32 rounded-xl flex-shrink-0 overflow-hidden group flex items-center justify-center",style:{backgroundColor:"var(--color-bg-section)",borderColor:"var(--color-border-light)"},children:u(r.image)?e.jsx("img",{src:u(r.image),alt:r.name,className:"w-full h-full object-cover group-hover:scale-110 transition duration-300 rounded-xl"}):e.jsx("div",{className:"text-4xl",children:"ðŸ›ï¸"})}),e.jsxs("div",{className:"grow",children:[e.jsxs("div",{className:"flex justify-between items-start mb-3",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-xl mb-1",style:{color:"var(--color-text-primary)"},children:r.name}),e.jsx("div",{className:"flex items-center gap-2 mt-2",children:e.jsx("span",{className:"inline-block px-2 py-1 text-xs font-semibold rounded",style:{backgroundColor:"var(--color-accent-primary)",color:"white"},children:"VAT 0%"})})]}),e.jsxs("p",{className:"text-2xl font-bold",style:{color:"var(--color-accent-primary)"},children:["Â£",Number(r.price).toFixed(2)]})]}),(r.selectedSize||r.selectedColor||r.selectedVariants&&Object.keys(r.selectedVariants).length>0)&&e.jsx("div",{className:"mt-4 pt-4",style:{borderColor:"var(--color-border-light)",borderTopWidth:"1px"},children:e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[r.selectedSize&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("i",{className:"fas fa-box text-sm",style:{color:"var(--color-accent-primary)"}}),e.jsxs("span",{className:"text-sm",children:[e.jsx("span",{className:"font-semibold",style:{color:"var(--color-text-primary)"},children:"Size:"}),e.jsx("span",{className:"ml-1",style:{color:"var(--color-text-secondary)"},children:r.selectedSize})]})]}),r.selectedColor&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("i",{className:"fas fa-tag text-sm",style:{color:"var(--color-accent-primary)"}}),e.jsxs("span",{className:"text-sm",children:[e.jsx("span",{className:"font-semibold",style:{color:"var(--color-text-primary)"},children:"Color:"}),e.jsx("span",{className:"ml-1",style:{color:"var(--color-text-secondary)"},children:r.selectedColor})]})]}),r.selectedVariants&&Object.entries(r.selectedVariants).filter(([e,r])=>r).map(([r,o])=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("i",{className:"fas fa-check text-sm",style:{color:"var(--color-accent-primary)"}}),e.jsxs("span",{className:"text-sm",children:[e.jsxs("span",{className:"font-semibold",style:{color:"var(--color-text-primary)"},children:[r,":"]}),e.jsx("span",{className:"ml-1",style:{color:"var(--color-text-secondary)"},children:o})]})]},r))]})})]})]}),e.jsxs("div",{className:"flex sm:flex-row sm:items-center justify-between gap-4 pt-4",style:{borderColor:"var(--color-border-light)",borderTopWidth:"1px"},children:[e.jsxs("div",{className:"flex items-center rounded-lg w-fit",style:{borderWidth:"2px",borderColor:"var(--color-border-light)",backgroundColor:"var(--color-bg-primary)"},children:[e.jsx("button",{onClick:()=>t(r._id,r.quantity-1),className:"px-3 py-2 font-bold text-lg transition duration-300 disabled:opacity-50 disabled:cursor-not-allowed",style:{color:"var(--color-accent-primary)"},onMouseEnter:e=>e.target.style.backgroundColor="var(--color-bg-section)",onMouseLeave:e=>e.target.style.backgroundColor="transparent",disabled:r.quantity<=1,children:"âˆ’"}),e.jsx("span",{className:"px-3 py-2 font-bold text-lg w-10 text-center",style:{borderLeftWidth:"2px",borderRightWidth:"2px",borderColor:"var(--color-border-light)",color:"var(--color-text-primary)"},children:r.quantity}),e.jsx("button",{onClick:()=>t(r._id,r.quantity+1),className:"px-3 py-2 font-bold text-lg transition duration-300",style:{color:"var(--color-accent-primary)"},onMouseEnter:e=>e.target.style.backgroundColor="var(--color-bg-section)",onMouseLeave:e=>e.target.style.backgroundColor="transparent",children:"+"})]}),e.jsx("div",{className:"flex items-center justify-between sm:justify-end gap-8",children:e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-sm",style:{color:"var(--color-text-secondary)"},children:"Subtotal"}),e.jsxs("p",{className:"font-bold text-2xl",style:{color:"var(--color-accent-primary)"},children:["Â£",(Number(r.price)*r.quantity).toFixed(2)]})]})}),e.jsx("button",{onClick:()=>{try{"function"==typeof o&&o(r._id)}catch(e){}},className:"w-16 sm:w-auto px-4 py-2 font-semibold flex items-center justify-center gap-2 transition duration-300 rounded-lg",style:{borderWidth:"2px",borderColor:"var(--color-border-light)",color:"var(--color-accent-primary)"},onMouseEnter:e=>e.target.style.backgroundColor="var(--color-bg-section)",onMouseLeave:e=>e.target.style.backgroundColor="transparent",children:e.jsx("i",{className:"fas fa-trash text-sm"})})]})]}),!a&&e.jsx("div",{style:{borderBottomColor:"var(--color-border-light)",borderBottomWidth:"1px"}})]}),b=({totalPrice:o=0,totalQuantity:t=0,onCheckout:s,onClearCart:a,shippingCost:l=0,taxCost:c=0,finalTotal:n=0,appliedCoupon:i,discountAmount:d=0,onApplyCoupon:m,onRemoveCoupon:x})=>{const[p,y]=r.useState(""),[u,h]=r.useState(!1),b=async()=>{h(!0),await m(p),h(!1)};return e.jsxs("div",{className:"rounded-2xl shadow-lg border p-8 sticky top-24 space-y-8",style:{backgroundColor:"var(--color-bg-section)",borderColor:"var(--color-border-light)"},children:[e.jsxs("h2",{className:"text-3xl font-bold flex items-center gap-2",style:{color:"var(--color-text-primary)"},children:[e.jsx("i",{className:"fas fa-box",style:{color:"var(--color-accent-primary)"}})," Order Summary"]}),e.jsxs("div",{className:"border-l-4 p-6 rounded-xl",style:{backgroundColor:"var(--color-bg-secondary)",borderColor:"var(--color-accent-primary)"},children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("i",{className:"fas fa-truck text-xl",style:{color:"var(--color-accent-primary)"}}),e.jsx("p",{className:"font-bold text-lg",style:{color:"var(--color-text-primary)"},children:"Free Shipping"})]}),e.jsx("p",{className:"text-sm",style:{color:"var(--color-text-secondary)"},children:"Shipping is free for all orders"})]}),e.jsxs("div",{className:"space-y-4 pb-8",style:{borderBottomColor:"var(--color-border-light)"},children:[e.jsxs("div",{className:"flex justify-between text-base",style:{borderColor:"var(--color-border-light)"},children:[e.jsx("span",{className:"font-medium",style:{color:"var(--color-text-secondary)"},children:"Subtotal"}),e.jsxs("span",{className:"font-semibold",style:{color:"var(--color-text-primary)"},children:["Â£",(o||0).toFixed(2)]})]}),e.jsxs("div",{className:"flex justify-between text-base",children:[e.jsx("span",{className:"font-medium",style:{color:"var(--color-text-secondary)"},children:"Shipping"}),e.jsx("span",{className:"font-semibold",style:{color:0===(l||0)?"var(--color-text-light)":"var(--color-text-primary)"},children:0===(l||0)?"FREE":`Â£${(l||0).toFixed(2)}`})]}),e.jsxs("div",{className:"flex justify-between text-base items-center",children:[e.jsx("span",{className:"font-medium",style:{color:"var(--color-text-secondary)"},children:"VAT"}),e.jsx("span",{className:"inline-block px-2 py-1 text-xs font-semibold rounded",style:{backgroundColor:"var(--color-accent-primary)",color:"white"},children:"0%"})]}),(d||0)>0&&e.jsxs("div",{className:"flex justify-between text-base items-center pt-2",style:{borderTopColor:"var(--color-border-light)",borderTopWidth:"1px"},children:[e.jsxs("span",{className:"font-medium flex items-center gap-2",style:{color:"var(--color-accent-primary)"},children:[e.jsx("i",{className:"fas fa-tag text-sm"})," Discount"]}),e.jsxs("span",{className:"font-semibold",style:{color:"var(--color-accent-primary)"},children:["-Â£",(d||0).toFixed(2)]})]})]}),i?e.jsxs("div",{className:"p-4 rounded-lg flex items-center justify-between",style:{backgroundColor:"var(--color-bg-secondary)",borderColor:"var(--color-accent-primary)",borderWidth:"2px"},children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-semibold",style:{color:"var(--color-accent-primary)"},children:"âœ“ Coupon Applied"}),e.jsx("p",{className:"text-xs",style:{color:"var(--color-text-secondary)"},children:i.code})]}),e.jsx("button",{onClick:x,className:"p-2 rounded-lg transition duration-300",style:{color:"var(--color-accent-primary)"},onMouseEnter:e=>e.target.style.opacity="0.7",onMouseLeave:e=>e.target.style.opacity="1",children:e.jsx("i",{className:"fas fa-times"})})]}):e.jsxs("div",{className:"space-y-3 pb-6",style:{borderBottomColor:"var(--color-border-light)",borderBottomWidth:"1px"},children:[e.jsx("label",{className:"text-sm font-semibold",style:{color:"var(--color-text-primary)"},children:"Apply Coupon Code"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:p,onChange:e=>y(e.target.value.toUpperCase()),placeholder:"Enter coupon code",className:"flex-1 px-3 py-2 rounded-lg text-sm border focus:outline-none focus:ring-2",style:{backgroundColor:"var(--color-bg-secondary)",borderColor:"var(--color-border-light)",color:"var(--color-text-primary)"},onKeyPress:e=>"Enter"===e.key&&b()}),e.jsx("button",{onClick:b,disabled:u||!p.trim(),className:"px-4 py-2 rounded-lg font-semibold text-sm transition duration-300 text-white disabled:opacity-50",style:{backgroundColor:"var(--color-accent-primary)"},onMouseEnter:e=>!u&&(e.target.style.backgroundColor="var(--color-accent-light)"),onMouseLeave:e=>e.target.style.backgroundColor="var(--color-accent-primary)",children:u?"Applying...":"Apply"})]})]}),e.jsxs("div",{className:"p-6 rounded-xl",style:{backgroundColor:"var(--color-bg-secondary)"},children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("span",{className:"font-medium",style:{color:"var(--color-text-secondary)"},children:"Total Items"}),e.jsx("span",{className:"font-bold text-lg",style:{color:"var(--color-text-primary)"},children:t})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-lg font-bold",style:{color:"var(--color-text-primary)"},children:"Total Amount"}),e.jsxs("span",{className:"text-2xl font-bold",style:{color:"var(--color-accent-primary)"},children:["Â£",(n||0).toFixed(2)]})]})]}),e.jsxs("div",{className:"space-y-4 pt-4",children:[e.jsxs("button",{onClick:s,className:"w-full text-white py-4 rounded-xl font-bold transition duration-300 text-lg transform hover:scale-105 shadow-lg flex items-center justify-center gap-2",style:{backgroundColor:"var(--color-accent-primary)"},onMouseEnter:e=>e.target.style.backgroundColor="var(--color-accent-light)",onMouseLeave:e=>e.target.style.backgroundColor="var(--color-accent-primary)",children:[e.jsx("i",{className:"fas fa-check"})," Proceed to Checkout"]}),e.jsx("button",{onClick:a,className:"w-full py-4 rounded-xl font-bold transition duration-300 text-lg",style:{borderColor:"var(--color-accent-primary)",color:"var(--color-accent-primary)",borderWidth:"2px",backgroundColor:"transparent"},onMouseEnter:e=>e.target.style.backgroundColor="var(--color-bg-section)",onMouseLeave:e=>e.target.style.backgroundColor="transparent",children:"Clear Cart"})]})]})},g=()=>{const y=s(),u=o(),{token:g}=l(),{items:v,totalPrice:f,totalQuantity:j}=a(e=>e.cart),[N,C]=r.useState(null),[k,w]=r.useState(0),S=async e=>{if(g)try{await fetch("https://api.wolfsupplies.co.uk/api/cart",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${g}`},body:JSON.stringify({items:e})})}catch(r){}};return e.jsx("div",{className:"min-h-screen bg-[var(--color-bg-primary)] py-16 px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs("div",{className:"mb-12",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("i",{className:"fas fa-shopping-cart text-4xl text-[var(--color-accent-primary)]"}),e.jsx("h1",{className:"text-5xl md:text-6xl font-bold text-[var(--color-text-primary)]",children:"Shopping Cart"})]}),e.jsx("p",{className:"text-xl text-[var(--color-text-light)]",children:0===v.length?"Your cart is empty":`You have ${j} item${1!==j?"s":""} in your cart`})]}),0===v.length?e.jsxs("div",{className:"text-center py-24 bg-[var(--color-bg-secondary)] rounded-3xl shadow-lg border-2 border-[var(--color-border-light)]",children:[e.jsx("i",{className:"fas fa-shopping-cart text-8xl text-[var(--color-text-muted)] mx-auto mb-6 block"}),e.jsx("p",{className:"text-3xl font-bold text-[var(--color-text-primary)] mb-4",children:"Your cart is empty"}),e.jsx("p",{className:"text-xl text-[var(--color-text-light)] mb-12",children:"Add some items to your cart to get started!"}),e.jsxs(t,{to:"/products",className:"inline-flex items-center gap-3 bg-[var(--color-accent-primary)] hover:bg-[var(--color-accent-light)] text-white px-10 py-4 rounded-lg font-bold text-lg transition duration-300 shadow-lg",children:[e.jsx("i",{className:"fas fa-arrow-left"})," Continue Shopping"]})]}):e.jsxs("div",{className:"grid lg:grid-cols-3 gap-10",children:[e.jsx("div",{className:"lg:col-span-2 space-y-6",children:e.jsx("div",{className:"bg-[var(--color-bg-primary)] rounded-2xl shadow-lg overflow-hidden border border-[var(--color-border-light)]",children:v.map((r,o)=>e.jsx(h,{item:r,onRemove:e=>{(e=>{(async()=>{try{const o=v.filter(r=>r._id!==e);if(y(x(e)),n.success("Item removed from cart"),g)try{await y(m(o)).unwrap()}catch(r){await S(o)}}catch(r){}})()})(e)},onUpdateQuantity:(e,r)=>{((e,r)=>{if(r<1)return;y(d({id:e,quantity:r}));const o=v.map(o=>o._id===e?{...o,quantity:r}:o);g&&y(m(o))})(e,r)},index:o,isLast:o===v.length-1},r._id))})}),e.jsx("div",{className:"lg:col-span-1",children:e.jsx(b,{totalPrice:f,totalQuantity:j,onCheckout:()=>{0!==v.length?u("/checkout",{state:{appliedCoupon:N,discountAmount:k}}):n.error("Your cart is empty")},onClearCart:async()=>{y(c()),C(null),w(0),n.success("Cart cleared"),g&&y(i())},shippingCost:0,taxCost:0,finalTotal:f-k,appliedCoupon:N,discountAmount:k,onApplyCoupon:async e=>{if(e.trim())try{const r="https://api.wolfsupplies.co.uk",o=v.map(e=>e.product),t=await fetch(`${r}/api/coupons/validate`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({code:e,orderTotal:f,cartItems:v,productIds:o})});if(!t.ok)throw new Error("Invalid or expired coupon");const s=await t.json(),a=s.coupon||s;let l=a.discount||0;if(!l){const e=parseFloat(a.discountValue)||0;let r=0;r="percentage"===a.discountType?f*e/100:e,l=Math.min(Math.max(0,r),f)}C(a),w(l),n.success(`Coupon applied! You saved Â£${l.toFixed(2)}`)}catch(r){n.error(r.message),C(null),w(0)}else n.error("Please enter a coupon code")},onRemoveCoupon:()=>{C(null),w(0),n.success("Coupon removed")}})})]}),v.length>0&&e.jsx("div",{className:"mt-20",children:e.jsx(p,{currentProductId:"",currentCategory:v[0]?.category||"Electronics",limit:4})})]})})};export{g as default};
