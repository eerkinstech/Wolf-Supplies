import{j as e}from"./editor-BiSlXHWs.js";import{a as t,g as r,u as s,L as a}from"./vendor-0z5P9xg-.js";import{u as l,d as i}from"./redux-DhaBhdiE.js";import{z as o,u as n,b as c,c as d,d as x,e as m,r as g,g as u}from"./index-BiO51Ilc.js";import{u as h}from"./useMetaTags-DJRkGa8w.js";import{R as p}from"./RelatedProducts-DNGsb14a.js";import{s as f}from"./Strip Logos-CD4uuqgq.js";import"./ProductCard-B1CLfHgm.js";const b=({product:r,token:s,user:a,onSubmitReview:l,requireReviewApproval:i,API:n})=>{const[c,d]=t.useState(!1),[x,m]=t.useState(5),[g,u]=t.useState(""),[h,p]=t.useState(!1),[f,b]=t.useState(0),[v,y]=t.useState(!1),j=(t=0,r="text-lg")=>{const s=[];for(let a=1;a<=5;a++)t>=a?s.push(e.jsx("i",{className:`fas fa-star ${r} text-yellow-400`},a)):t>=a-.5?s.push(e.jsx("i",{className:`fas fa-star-half-alt ${r} text-yellow-400`},a)):s.push(e.jsx("i",{className:`far fa-star ${r} text-yellow-400`},a));return s},N=Array.isArray(r?.reviews)?r.reviews:[],w=N.length>0?i?N.filter(e=>e&&!0===e.isApproved):N:[],k=w.slice().sort((e,t)=>{const r=new Date(e?.createdAt||e?.updatedAt||0).getTime();return new Date(t?.createdAt||t?.updatedAt||0).getTime()-r}),S=v?k:k.slice(0,8),C=w.length,$=C>8;return e.jsxs("div",{className:"bg-white p-10 rounded-2xl shadow-lg",children:[e.jsx("h2",{className:"text-3xl font-bold text-gray-900 mb-8",children:"Customer Reviews & Ratings"}),e.jsxs("div",{className:"grid md:grid-cols-3 gap-8 mb-12",children:[e.jsxs("div",{className:"bg-linear-to-br from-gray-100 to-gray-200 p-8 rounded-xl border-2 border-gray-400 text-center",children:[e.jsx("div",{className:"text-3xl font-bold text-gray-800 mb-4",children:r?.rating||4.6}),e.jsx("div",{className:"flex justify-center mb-4 text-3xl",children:j(r?.rating||0,"text-3xl")}),e.jsxs("p",{className:"text-gray-700 font-semibold",children:["Based on ",C," verified reviews"]})]}),e.jsx("div",{className:"col-span-2 space-y-4",children:(()=>{const t=w.length||0,r=[5,4,3,2,1].map(e=>w.filter(t=>Math.round(Number(t?.rating||0))===e).length);return[5,4,3,2,1].map((s,a)=>{const l=r[a],i=t?Math.round(l/t*100):0;return e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("span",{className:"font-semibold text-gray-700 w-16",children:[s," Star"]}),e.jsx("div",{className:"flex-1 bg-gray-200 rounded-full h-2 overflow-hidden",children:e.jsx("div",{className:"bg-gray-800 h-full transition-all",style:{width:`${i}%`}})}),e.jsxs("span",{className:"text-gray-600 font-semibold w-12",children:[i,"%"]})]},s)})})()})]}),e.jsxs("div",{className:"border-t pt-8",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-2xl font-bold text-gray-900",children:"Recent Reviews"}),e.jsx("button",{onClick:()=>{s?d(e=>!e):o("Please log in to leave a review",{icon:"ðŸ”’"})},className:"py-2 px-4 text-[10px] sm:text-xl bg-black text-white rounded-lg font-semibold hover:bg-black transition",children:c?"Cancel":"Write a review"})]}),h&&e.jsx("div",{className:"mb-4 p-4 rounded-lg bg-gray-50 border border-gray-200 text-gray-800",children:"Thank you â€” your review has been submitted."}),c&&e.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),s)try{await l({rating:x,comment:g,name:a?.name,email:a?.email}),d(!1),m(5),u(""),p(!0),setTimeout(()=>p(!1),3500)}catch(t){o.error(t.message||"Failed to submit review")}else o.error("Please log in to submit a review")},className:"bg-gray-50 p-6 rounded-lg mb-6",children:[e.jsxs("div",{className:"grid md:grid-cols-2 gap-4 mb-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Your Rating"}),e.jsx("div",{className:"mt-2 flex items-center gap-2",role:"radiogroup","aria-label":"Your rating",children:[1,2,3,4,5].map(t=>{const r=t<=(f||x);return e.jsx("button",{type:"button",onClick:()=>m(t),onMouseEnter:()=>b(t),onMouseLeave:()=>b(0),onKeyDown:e=>{"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),m(t))},"aria-checked":x===t,role:"radio","aria-label":`${t} star${t>1?"s":""}`,className:`focus:outline-none ${r?"text-gray-800":"text-gray-300"} text-2xl transition cursor-pointer`,children:r?e.jsx("i",{className:"fas fa-star"}):e.jsx("i",{className:"far fa-star"})},t)})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Your Name"}),e.jsx("input",{value:a?.name||"",disabled:!0,className:"w-full mt-2 p-3 border rounded-lg bg-white text-gray-700"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Your Email"}),e.jsx("input",{value:a?.email||"",disabled:!0,className:"w-full mt-2 p-3 border rounded-lg bg-white text-gray-700"})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Your Review"}),e.jsx("textarea",{value:g,onChange:e=>u(e.target.value),rows:4,placeholder:"Share your experience with this product...",className:"w-full mt-2 p-3 border rounded-lg focus:border-gray-400 focus:outline-none"})]}),e.jsx("div",{className:"text-right",children:e.jsx("button",{type:"submit",className:"py-3 px-6 bg-black text-white rounded-lg font-semibold hover:bg-black transition",children:"Submit Review"})})]}),e.jsxs("div",{className:"space-y-6",children:[S.length>0?e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6",children:S.map(t=>{const r=t?._id?`review-${t._id}`:`review-${Math.random()}`,s=t?.name||t?.user?.name||"Customer",a=t?.user?.email||"",l=Number(t?.rating||0),i=t?.comment||"",o=!0===t?.isApproved;return new Date(t?.createdAt||t?.updatedAt||Date.now()).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),e.jsxs("div",{className:"p-6 rounded-lg border transition-all hover:shadow-md bg-gray-50 border-gray-200",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-bold text-gray-900 text-sm",children:s}),a&&e.jsx("p",{className:"text-xs text-gray-900",children:a}),o&&e.jsx("span",{className:"inline-block mt-1 px-2 py-0.5 bg-gray-100 text-gray-800 text-xs font-semibold rounded",children:"âœ“ Verified"})]}),e.jsx("div",{className:"flex text-gray-800",children:j(l,"text-xs")})]}),e.jsx("p",{className:"text-gray-700 text-sm leading-relaxed line-clamp-3 mb-3",children:i})]},r)})}):e.jsxs("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-8 text-center",children:[e.jsx("p",{className:"text-gray-600 font-semibold mb-2",children:"No reviews yet"}),e.jsx("p",{className:"text-gray-900 text-sm",children:"Be the first to share your experience with this product!"})]}),$&&e.jsx("div",{className:"flex justify-center pt-6 border-t",children:e.jsx("button",{onClick:()=>y(e=>!e),className:"py-2 px-6 bg-black text-white rounded-lg font-semibold hover:bg-black transition-colors",children:v?"Show fewer reviews":`Show all ${C} reviews`})})]})]})]})},v=()=>{const{id:v,slug:y}=r(),j=s(),N=l(),{product:w,loading:k}=i(e=>e.product),S=i(e=>e.wishlist.items),[C,$]=t.useState(1),[A,z]=t.useState(!1),[I,O]=t.useState(null),[P,E]=t.useState(!1),[R,_]=t.useState(null),[M,T]=t.useState(null),[V,D]=t.useState({}),[W,F]=t.useState(0),[L,q]=t.useState(0),B=t.useRef(null),[H,Y]=t.useState(!1),[K,U]=t.useState(!1),[G,J]=t.useState("description"),[Q,X]=t.useState(!1),[Z,ee]=t.useState(0),[te,re]=t.useState({x:0,y:0}),se=t.useRef(null),ae=t.useRef(0),[le,ie]=t.useState(!0),{token:oe,user:ne}=n(),ce=i(e=>e.cart.items),de="https://api.wolfsupplies.co.uk",xe=e=>{if(!e)return"";if("string"==typeof e)return e.trim()?e.startsWith("http")?e:`${de}${e}`:"";if("object"==typeof e){const t=e.url||e.secure_url||e.public_url||e.path||e.src||"";if(!t)return"";if("string"==typeof t)return t.startsWith("http")?t:`${de}${t}`}return""};h({title:w?.metaTitle||w?.name||"Product",description:w?.metaDescription||w?.description||"Browse our product selection",keywords:w?.metaKeywords||"",image:w?.images?.[0]||"",url:"undefined"!=typeof window?window.location.href:""}),t.useEffect(()=>{(async()=>{try{const e=await fetch(`${de}/api/settings`);if(!e.ok)throw new Error("Failed to fetch settings");const t=await e.json();ie(!1!==t.requireReviewApproval)}catch(e){}})()},[de]),t.useEffect(()=>{$(1),_(null),T(null),D({}),F(0),z(!1),O(null),E(!1);(y||v)&&N(y?c(y):d(v))},[v,y,N]),t.useEffect(()=>{ae.current>0&&!k&&requestAnimationFrame(()=>{window.scrollTo(0,ae.current),ae.current=0})},[w,k]),t.useEffect(()=>{ae.current>0&&requestAnimationFrame(()=>{requestAnimationFrame(()=>{window.scrollTo(0,ae.current),ae.current=0})})},[G]),t.useEffect(()=>{if(!w)return;let e=null;if(w.variantCombinations&&w.variantCombinations.length>0){const t={...V||{}};R&&(t.Size=R),M&&(t.Color=M);for(const r of w.variantCombinations){const s=r.variantValues||{},a=s instanceof Map?Object.fromEntries(s):s,l=Object.keys(a);let i=!0;for(const e of l){const r=a[e],s=t[e];if(void 0!==r&&(void 0===s||String(s)!==String(r))){i=!1;break}}if(i){e=r._id||r.id||null;break}}}const t={variantId:e||null,selectedSize:R||null,selectedColor:M||null,selectedVariants:V||{}},r=e=>{if(!e)return!1;if(e.variantId&&t.variantId&&String(e.variantId)===String(t.variantId))return!0;const r=e.selectedSize||null,s=e.selectedColor||null,a=e.selectedVariants||{};if(r&&t.selectedSize&&String(r)===String(t.selectedSize)&&s&&t.selectedColor&&String(s)===String(t.selectedColor))return!0;const l=Object.keys(a||{}).sort(),i=Object.keys(t.selectedVariants||{}).sort();if(l.length&&l.length===i.length){for(let e=0;e<l.length;e++){const r=l[e];if(String(a[r])!==String(t.selectedVariants[r]))return!1}return!0}return!1};let s=!1;for(const a of S){const e=a.productId||a.product&&(a.product._id||a.product)||a._id||a.product;if(String(e)!==String(w._id))continue;if(!(a.__isSnapshot||void 0!==a.snapshot||!!a.variantId||w.variantCombinations&&0!==w.variantCombinations.length)){s=!0;break}const t=a.snapshot?a.snapshot:a,l=a.variantId||t.variantId||null;if(r({...t,variantId:l})){s=!0;break}}s||(t.variantId?I&&String(I)===String(t.variantId)&&(s=!0):P&&(s=!0)),z(!!s),w.variantCombinations&&w.variantCombinations.length>0&&P&&E(!1),I&&t.variantId&&String(I)!==String(t.variantId)&&O(null)},[w,S,V,R,M]),t.useEffect(()=>{if(w&&w.variants&&w.variants.length>0&&w.variantCombinations&&w.variantCombinations.length>0&&0===Object.keys(V).length){const e={};for(const r of w.variantCombinations){const t=r.variantValues||{};for(const[r,s]of Object.entries(t))e[r]||(e[r]=new Set),e[r].add(String(s))}const t={};for(const[r,s]of Object.entries(e)){const e=Array.from(s).sort();t[r]=e[0]}Object.keys(t).length>0&&D(t)}},[w]),t.useEffect(()=>{F(0),q(0)},[V,R,M]);const me=(()=>{if(!w)return[];const e={...V||{}};R&&(e.Size=R),M&&(e.Color=M);let t=null;for(const a of w.variantCombinations||[]){const r=a.variantValues||{},s=r instanceof Map?Object.fromEntries(r):r,l=Object.keys(s);let i=!0;for(const t of l){const r=s[t],a=e[t];if(void 0!==r&&(void 0===a||String(a)!==String(r))){i=!1;break}}if(i){t=a;break}}const r=e=>e?"string"==typeof e?e:"object"==typeof e&&(e.url||e.secure_url||e.public_url||e.path||e.src)||"":"",s=(w?.images||[]).map(r).filter(Boolean);if(t&&t.image){const e=r(t.image);if(e){const t=s.filter(t=>t!==e);return[e,...t]}}return 0===s.length&&w.image?[r(w.image)]:s})(),ge=me&&me.length>0?me[W]:w?.image||"ðŸ›ï¸";t.useEffect(()=>{me&&0!==me.length?q(e=>Math.max(0,Math.min(Math.max(0,me.length-7),e))):q(0)},[W,me]),t.useEffect(()=>{const e=B.current;if(!e)return;const t=e.querySelectorAll("button")[W];t&&t.scrollIntoView&&t.scrollIntoView({behavior:"smooth",inline:"center",block:"nearest"});const r=()=>{e&&(Y(e.scrollLeft>8),U(e.scrollWidth-e.clientWidth-e.scrollLeft>8))},s=setTimeout(r,120);return r(),()=>clearTimeout(s)},[W,me]),t.useEffect(()=>{const e=B.current;if(!e)return;const t=()=>{Y(e.scrollLeft>8),U(e.scrollWidth-e.clientWidth-e.scrollLeft>8)};return e.addEventListener("scroll",t),t(),()=>e.removeEventListener("scroll",t)},[me]);const ue=async()=>{if(w){if(!fe)return void o.error("This item is out of stock");if(w.specifications?.sizes&&!R)return void o.error("Please select a size");if(w.specifications?.colors&&!M)return void o.error("Please select a color");if(w.variants&&Object.keys(w.variants).length>0)for(const[e,c]of Object.entries(w.variants))if(c.required&&!V[e])return void o.error(`Please select ${e}`);const t=me&&me.length>0?me[0]:w.image||w.images&&w.images[0]||"";let r="";"string"==typeof t?r=t:t&&"object"==typeof t&&(r=t.url||t.src||t.path||"");let s=null;he&&he.image&&(s=xe(he.image));const a={_id:((e,t,r,s)=>{const a=[e||""];if(a.push(`size:${t||""}`),a.push(`color:${r||""}`),s&&"object"==typeof s){const e=Object.keys(s).sort().map(e=>`${e}:${s[e]}`);a.push(`vars:${e.join(",")}`)}else a.push("vars:");return a.join("|")})(w._id,R,M,V),product:w._id,name:w.name,image:r,variantImage:s||r,price:Number(he?.price??w.price??0),category:w.category,discount:w.discount,quantity:C,selectedSize:R,selectedColor:M,selectedVariants:w.variants&&w.variants.length>0?V:{},variant:w.variants&&w.variants.length>0&&Object.values(V).join(" - ")||null,sku:he?.sku||w.sku||null,colorCode:V?.Color?"#cccccc":null};N(x(a));const l=(e,t)=>{if(!e||!t)return!1;if((e.product||"")!==(t.product||""))return!1;if((e.selectedSize||"")!==(t.selectedSize||""))return!1;if((e.selectedColor||"")!==(t.selectedColor||""))return!1;const r=e.selectedVariants||{},s=t.selectedVariants||{},a=Object.keys(r).sort(),l=Object.keys(s).sort();if(a.length!==l.length)return!1;for(let i=0;i<a.length;i++){const e=a[i];if(e!==l[i])return!1;if(String(r[e])!==String(s[e]))return!1}return!0};let i=[];i=ce.find(e=>l(e,a))?ce.map(e=>l(e,a)?{...e,quantity:(e.quantity||0)+(a.quantity||1)}:e):[...ce,a];try{await N(m(i))}catch(e){o.error("Failed to save cart to server")}const n=Object.entries(V).map(([e,t])=>`${e}: ${t}`).join(", ");o.success(`${C} item(s) added to cart! ${n}`)}};if(k)return e.jsx("div",{className:"min-h-screen flex justify-center items-center bg-[var(--color-bg-section)]",children:e.jsx("i",{className:"fas fa-spinner text-6xl text-[var(--color-text-light)] animate-spin"})});if(!w)return e.jsxs("div",{className:"min-h-screen flex flex-col justify-center items-center bg-[var(--color-bg-section)]",children:[e.jsx("p",{className:"text-3xl text-[var(--color-text-light)] mb-6",children:"Product not found"}),e.jsx("button",{onClick:()=>j("/products"),className:"bg-[var(--color-accent-primary)] hover:bg-[var(--color-accent-light)] text-white px-8 py-3 rounded-lg font-bold transition duration-300",children:"Browse Products"})]});const he=(()=>{if(!w||!w.variantCombinations||0===w.variantCombinations.length)return null;const e={...V||{}};R&&(e.Size=R),M&&(e.Color=M);for(const t of w.variantCombinations){const r=t.variantValues||{},s=r instanceof Map?Object.fromEntries(r):r,a=Object.keys(s);let l=!0;for(const t of a){const r=s[t],a=e[t];if(void 0!==r&&(void 0===a||String(a)!==String(r))){l=!1;break}}if(l)return t}return null})();let pe=null;pe=he?Number(he.stock||0):w.variantCombinations&&w.variantCombinations.length>0?null:Number(w.stock||0);const fe=null!==pe?pe>0:!!w.inStock,be=(()=>{if(!w.variantCombinations||0===w.variantCombinations.length)return{};const e={};for(const r of w.variantCombinations){const t=r.variantValues||{};for(const[r,s]of Object.entries(t))e[r]||(e[r]=new Set),e[r].add(String(s))}const t={};for(const[r,s]of Object.entries(e))t[r]=Array.from(s).sort();return t})();return e.jsxs("div",{className:"min-h-screen bg-white",children:[e.jsx("div",{className:"bg-[var(--color-bg-primary)] border-b border-[var(--color-border-light)]",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4",children:e.jsxs("div",{className:"flex items-center gap-2 text-[var(--color-text-light)]",children:[e.jsx("button",{onClick:()=>j("/"),className:"hover:text-[var(--color-accent-primary)] transition",children:"Home"}),e.jsx("span",{children:"/"}),e.jsx("button",{onClick:()=>j("/products"),className:"hover:text-[var(--color-accent-primary)] transition",children:"Products"}),e.jsx("span",{children:"/"}),e.jsx("span",{className:"text-[var(--color-accent-primary)] font-semibold",children:w.name})]})})}),e.jsxs("div",{className:"max-w-full mx-auto px-2 sm:px-2 lg:px-2 py-8",children:[e.jsxs("div",{className:"grid lg:grid-cols-2 gap-5 mb-16",children:[e.jsx("div",{className:"space-y-4",children:e.jsx("div",{className:" rounded-2xl  overflow-hidden p-2 sticky",style:{top:"var(--pdp-sticky-offset, 0px)"},children:e.jsxs("div",{className:"flex flex-col lg:flex-row gap-3 w-full",children:[me.length>1&&e.jsx("div",{className:"w-full lg:flex-shrink-0 lg:w-auto",children:e.jsx("div",{ref:B,className:"flex lg:flex-col gap-2 lg:gap-3 overflow-x-auto lg:overflow-y-auto lg:overflow-x-hidden px-1 rounded-lg hide-scrollbar",style:{height:"auto",minHeight:"auto",scrollBehavior:"smooth",maxWidth:"400px",maxHeight:"500px",lg:{maxHeight:"500px",maxWidth:"none",minWidth:"120px",minHeight:"400px"}},children:me&&me.length>0?me.map((t,r)=>e.jsx("button",{onClick:()=>F(r),className:"flex-shrink-0 w-16 h-16 lg:w-20 lg:h-20 rounded-lg overflow-hidden border-3 transition-all duration-300 hover:scale-105 "+(W===r?"border-[var(--color-accent-primary)] shadow-lg":"border-[var(--color-border-light)] hover:border-[var(--color-accent-primary)] shadow-sm"),children:e.jsx("img",{src:xe(t),alt:`Thumbnail ${r+1}`,className:"w-full h-full object-contain",onError:e=>{e.target.style.opacity="0"}},`thumb-${r}`)},r)):e.jsx("div",{className:"w-20 h-20 bg-[var(--color-bg-section)] rounded-lg flex items-center justify-center text-[var(--color-text-light)]",children:e.jsx("span",{className:"text-xs text-center",children:"No Images"})})})}),e.jsx("div",{className:"flex-1 flex flex-col w-full",children:e.jsxs("div",{className:"relative rounded-xl overflow-hidden group cursor-zoom-in flex items-center justify-center mx-auto lg:mx-0",style:{aspectRatio:"1/1",width:"100%",maxWidth:"100%",height:"auto"},onClick:()=>{ee(W),X(!0)},children:[me&&me.length>0?e.jsx("img",{src:xe(ge),alt:w.name,className:"w-full h-full object-contain group-hover:scale-105 transition duration-500",onError:e=>{e.target.style.opacity="0"}},W):e.jsx("div",{className:"text-[var(--color-text-light)] text-center",children:e.jsx("p",{className:"text-lg font-semibold",children:"No Images Available"})}),me&&me.length>1&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:e=>{e.stopPropagation(),F(e=>{const t=(e-1+me.length)%me.length;return q(e=>Math.max(0,Math.min(Math.max(0,me.length-7),e-1))),t})},className:"absolute left-4 top-1/2 -translate-y-1/2 bg-[var(--color-accent-primary)] bg-opacity-70 hover:bg-opacity-100 text-white p-3 rounded-full transition-all z-10 shadow-lg flex items-center justify-center","aria-label":"Previous image",children:e.jsx("i",{className:"fas fa-arrow-left text-lg"})}),e.jsx("button",{onClick:e=>{e.stopPropagation(),F(e=>{const t=(e+1)%me.length;return q(e=>Math.min(Math.max(0,me.length-7),e+1)),t})},className:"absolute right-4 top-1/2 -translate-y-1/2 bg-[var(--color-accent-primary)] bg-opacity-70 hover:bg-opacity-100 text-white p-3 rounded-full transition-all z-10 shadow-lg flex items-center justify-center","aria-label":"Next image",children:e.jsx("i",{className:"fas fa-arrow-right text-lg"})})]})]})})]})})}),e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"m-0",children:[(he?.sku||w.sku)&&e.jsxs("div",{className:"text-sm text-[var(--color-text-light)] mb-3 font-semibold",children:["SKU: ",he?.sku||w.sku]}),e.jsx("h1",{className:"text-3xl font-bold text-[var(--color-text-primary)] leading-tight",children:w.name}),(w.numReviews||w.reviews?.length||0)>0&&e.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"flex",children:((t=0,r="text-lg")=>{const s=[];for(let a=1;a<=5;a++)t>=a?s.push(e.jsx("i",{className:`fas fa-star ${r} text-yellow-400`},a)):t>=a-.5?s.push(e.jsx("i",{className:`fas fa-star-half ${r} text-yellow-400`},a)):s.push(e.jsx("i",{className:`far fa-star ${r} text-yellow-400`},a));return s})(w.rating||0,"text-lg")}),e.jsx("span",{className:"text-lg font-bold text-[var(--color-text-primary)]",children:(w.rating||0).toFixed(1)})]}),e.jsxs("span",{className:"text-[var(--color-text-light)]",children:["(",w.numReviews||w.reviews?.length||0," verified reviews)"]})]})]}),e.jsxs("div",{className:"bg-white p-4",children:[e.jsxs("div",{className:"flex items-baseline gap-4 mb-4",children:[e.jsxs("span",{className:"text-2xl font-bold text-[var(--color-accent-primary)]",children:["Â£",he?.price||w.price]}),w.originalPrice&&e.jsx(e.Fragment,{children:e.jsxs("span",{className:"text-3xl text-[var(--color-text-light)] line-through",children:["Â£",w.originalPrice]})})]}),e.jsx("p",{className:"text-[var(--color-text-light)] font-semibold",children:"âœ“ Great Price â€¢ Free Shipping In UK Everywhere"}),e.jsx("p",{className:"text-[var(--color-text-light)] text-sm mt-2",children:"VAT 0 - We don't claim VAT"})]}),e.jsx("div",{className:"p-4 bg-[var(--color-bg-section)] border-l-4 border-[var(--color-accent-primary)] rounded-lg",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"text-2xl "+(fe?"text-green-400":"text-red-600"),children:fe?"âœ“":"âœ—"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-bold text-lg "+(fe?"text-[var(--color-text-primary)]":"text-red-600"),children:fe?"In Stock - Ships Today!":"Out of Stock"}),e.jsx("p",{className:"text-[var(--color-text-light)] text-sm",children:fe?"Available for immediate dispatch":"This item is currently unavailable"})]})]})}),e.jsxs("div",{className:"space-y-6",children:[w.specifications?.sizes&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"block text-sm font-bold text-[var(--color-text-primary)] uppercase tracking-wide",children:["Size ",R&&e.jsxs("span",{className:"text-[var(--color-text-light)]",children:["- ",R]})]}),e.jsx("select",{value:R||"",onChange:e=>_(e.target.value||null),className:"w-full px-4 py-3 border-2 border-[var(--color-border-light)] rounded-lg font-semibold text-[var(--color-text-primary)] bg-[var(--color-bg-primary)] cursor-pointer hover:border-[var(--color-accent-primary)] transition focus:outline-none focus:border-[var(--color-accent-primary)]",children:w.specifications.sizes.map(t=>e.jsx("option",{value:t,children:t},t))})]}),w.specifications?.colors&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"block text-sm font-bold text-[var(--color-text-primary)] uppercase tracking-wide",children:["Color ",M&&e.jsxs("span",{className:"text-[var(--color-text-light)]",children:["- ",M]})]}),e.jsx("select",{value:M||"",onChange:e=>T(e.target.value||null),className:"w-full px-4 py-3 border-2 border-[var(--color-border-light)] rounded-lg font-semibold text-[var(--color-text-primary)] bg-[var(--color-bg-primary)] cursor-pointer hover:border-[var(--color-accent-primary)] transition focus:outline-none focus:border-[var(--color-accent-primary)]",children:w.specifications.colors.map(t=>e.jsx("option",{value:t,children:t},t))})]}),Object.keys(be).length>0&&Object.entries(be).map(([t,r])=>e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"block text-sm font-bold text-[var(--color-text-primary)] uppercase tracking-wide",children:[t," ",V[t]&&e.jsxs("span",{className:"text-[var(--color-text-light)]",children:["- ",V[t]]})]}),e.jsx("select",{value:V[t]||"",onChange:e=>D({...V,[t]:e.target.value||null}),className:"w-full px-4 py-3 border-2 border-[var(--color-border-light)] rounded-lg font-semibold text-[var(--color-text-primary)] bg-[var(--color-bg-primary)] cursor-pointer hover:border-[var(--color-accent-primary)] transition focus:outline-none focus:border-[var(--color-accent-primary)]",children:r.map(t=>e.jsx("option",{value:t,children:t},t))})]},t)),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex items-center border-2 border-[var(--color-border-light)] rounded-lg overflow-hidden bg-[var(--color-bg-primary)]",children:[e.jsx("button",{onClick:()=>$(Math.max(1,C-1)),className:"px-6 py-3 hover:bg-[var(--color-bg-section)] font-bold text-lg text-[var(--color-text-primary)] transition",children:"âˆ’"}),e.jsx("span",{className:"px-8 py-3 border-l-2 border-r-2 border-[var(--color-border-light)] font-bold text-xl text-[var(--color-text-primary)]",children:C}),e.jsx("button",{onClick:()=>$(C+1),className:"px-6 py-3 hover:bg-[var(--color-bg-section)] font-bold text-lg text-[var(--color-text-primary)] transition",children:"+"})]}),e.jsxs("button",{onClick:ue,disabled:!fe,className:"flex-1 px-8 py-4 rounded-lg font-bold transition duration-300 flex items-center justify-center gap-3 text-lg shadow-lg "+(fe?"bg-[var(--color-accent-primary)] hover:bg-[var(--color-accent-light)] text-white":"bg-[var(--color-border-light)] text-[var(--color-text-light)] cursor-not-allowed"),children:[e.jsx("i",{className:"fas fa-shopping-cart"})," ",fe?"Add to Cart":"Sold Out"]})]}),e.jsxs("button",{onClick:()=>{fe&&(ue(),j("/checkout"))},disabled:!fe,className:"w-full px-8 py-4 rounded-lg font-bold transition duration-300 flex items-center justify-center gap-3 text-lg shadow-lg "+(fe?"bg-[var(--color-accent-primary)] hover:bg-[var(--color-accent-light)] text-white":"bg-[var(--color-border-light)] text-[var(--color-text-light)] cursor-not-allowed"),children:[e.jsx("i",{className:"fas fa-check"})," ",fe?"Buy Now":"Sold Out"]}),(R&&w.specifications?.sizes||M&&w.specifications?.colors||Object.values(V).some(e=>e)&&Object.keys(be).length>0)&&e.jsxs("div",{className:"bg-[var(--color-bg-section)] p-6 rounded-lg border-2 border-[var(--color-accent-primary)]",children:[e.jsxs("h4",{className:"font-bold text-lg text-[var(--color-text-primary)] mb-4 flex items-center gap-2",children:[e.jsx("span",{className:"bg-[var(--color-accent-primary)] text-white px-3 py-1 rounded-full text-sm",children:"âœ“"}),"Your Selection Summary"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[R&&e.jsxs("div",{className:"bg-[var(--color-bg-primary)] p-3 rounded-lg",children:[e.jsx("p",{className:"text-xs text-[var(--color-text-light)] font-semibold uppercase",children:"Size"}),e.jsx("p",{className:"text-lg font-bold text-[var(--color-accent-primary)]",children:R})]}),M&&e.jsxs("div",{className:"bg-[var(--color-bg-primary)] p-3 rounded-lg",children:[e.jsx("p",{className:"text-xs text-[var(--color-text-light)] font-semibold uppercase",children:"Color"}),e.jsx("p",{className:"text-lg font-bold text-[var(--color-accent-primary)]",children:M})]}),Object.entries(V).filter(([e,t])=>t).map(([t,r])=>e.jsxs("div",{className:"bg-[var(--color-bg-primary)] p-3 rounded-lg",children:[e.jsx("p",{className:"text-xs text-[var(--color-text-light)] font-semibold uppercase",children:t}),e.jsx("p",{className:"text-lg font-bold text-[var(--color-accent-primary)]",children:r})]},t)),e.jsxs("div",{className:"bg-[var(--color-bg-primary)] p-3 rounded-lg",children:[e.jsx("p",{className:"text-xs text-[var(--color-text-light)] font-semibold uppercase",children:"Quantity"}),e.jsxs("p",{className:"text-lg font-bold text-[var(--color-accent-primary)]",children:["x",C]})]}),e.jsxs("div",{className:"bg-[var(--color-bg-primary)] p-3 rounded-lg col-span-2",children:[e.jsx("p",{className:"text-xs text-[var(--color-text-light)] font-semibold uppercase",children:"Total Price"}),e.jsxs("p",{className:"text-2xl font-bold text-[var(--color-accent-primary)]",children:["Â£",((he?.price||w.price)*C).toFixed(2)]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("button",{onClick:()=>{if(w){localStorage.getItem("token");const e=he||null,t=e?._id||e?.id||null,r=me&&me.length>0?me[0]:w.image||w.images&&w.images[0]||"";let s="";"string"==typeof r?s=r:r&&"object"==typeof r&&(s=r.url||r.src||r.path||"");const a={productId:w._id,name:w.name,price:Number(he?.price??w.price??0),image:s,selectedVariants:V||{},selectedSize:R||null,selectedColor:M||null,variantId:t||null};A?(z(!1),O(null),E(!1),N(g({productId:w._id,variantId:t}))):(z(!0),t?(O(t),E(!1)):(O(null),E(!0)),N(u({productId:w._id,snapshot:a}))),o.success(A?"Removed from wishlist":"Added to wishlist!")}},className:"py-3 px-4 rounded-lg font-bold transition duration-300 flex items-center justify-center gap-2 "+(A?"bg-red-600 text-white hover:bg-red-700":"bg-[var(--color-accent-primary)] hover:bg-[var(--color-accent-light)] text-white"),children:[e.jsx("i",{className:"fas fa-heart"})," ",A?"Saved":"Save"]}),e.jsxs("button",{onClick:()=>{navigator.share&&w?navigator.share({title:w.name,text:`Check out this amazing product: ${w.name}`,url:window.location.href}):o.success("Link copied to clipboard!")},className:"py-3 px-4 rounded-lg font-bold bg-[var(--color-accent-primary)] text-white hover:bg-[var(--color-accent-light)] transition duration-300 flex items-center justify-center gap-2",children:[e.jsx("i",{className:"fas fa-share"})," Share"]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-0 bg-[var(--color-bg-primary)] border border-[var(--color-border-light)] rounded-lg overflow-hidden",children:[e.jsxs("div",{className:"flex gap-4 items-center p-6 border-b border-[var(--color-border-light)]",children:[e.jsx("div",{className:"text-3xl text-[var(--color-accent-primary)] flex-shrink-0",children:e.jsx("i",{className:"fas fa-truck"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-bold text-[var(--color-text-primary)] text-sm leading-tight",children:"Free Shipping: 2-4 Business Days"}),e.jsxs("p",{className:"text-[var(--color-text-light)] text-xs mt-1",children:["Ships within the United Kingdom only. ",e.jsx(a,{to:"/policies/shipping",className:"text-[var(--color-accent-primary)] hover:underline font-semibold",children:"See details â†’"})]})]})]}),e.jsxs("div",{className:"flex gap-4 items-center p-6 border-b border-[var(--color-border-light)]",children:[e.jsx("div",{className:"text-3xl text-[var(--color-accent-primary)] flex-shrink-0",children:e.jsx("i",{className:"fas fa-box"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-bold text-[var(--color-text-primary)] text-sm leading-tight",children:"31 Days Return & Refunds Policy"}),e.jsxs("p",{className:"text-[var(--color-text-light)] text-xs mt-1",children:["Full refund within 31 days of purchase.",e.jsx(a,{to:"/policies/returns-refund",className:"text-[var(--color-accent-primary)] hover:underline font-semibold",children:" See details â†’"})]})]})]}),e.jsxs("div",{className:"flex gap-4 items-center p-6",children:[e.jsx("div",{className:"text-3xl text-[var(--color-accent-primary)] flex-shrink-0",children:e.jsx("i",{className:"fas fa-lock"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"",children:e.jsx("img",{src:f,alt:"Payment methods",className:"h-8 object-contain"})}),e.jsx("p",{className:"text-[var(--color-text-light)] text-xs leading-relaxed",children:"All payments are processed securely in Â£ (Â£)."})]})]})]}),(()=>{if(!w.benefits)return!1;if("string"==typeof w.benefits){return w.benefits.replace(/<[^>]*>/g,"").trim().length>0}return!!Array.isArray(w.benefits)&&w.benefits.some(e=>{if(!e)return!1;return String(e).replace(/<[^>]*>/g,"").trim().length>0})})()&&e.jsxs("div",{className:"bg-[var(--color-bg-section)] p-6 rounded-xl border-l-4 border-[var(--color-accent-primary)]",children:[e.jsx("h3",{className:"font-bold text-lg text-[var(--color-text-primary)] mb-4",children:w.benefitsHeading||"Why Buy This Product?"}),"string"==typeof w.benefits?e.jsx("div",{className:"prose prose-sm max-w-none text-[var(--color-text-light)]",dangerouslySetInnerHTML:{__html:w.benefits}}):Array.isArray(w.benefits)?e.jsx("ul",{className:"space-y-2 text-[var(--color-text-light)]",children:w.benefits.map((t,r)=>t&&String(t).trim()?e.jsxs("li",{className:"flex items-center gap-3",children:[e.jsx("i",{className:"fas fa-check text-[var(--color-accent-primary)]"})," ",t]},r):null)}):null]})]})]}),e.jsxs("div",{className:"bg-[var(--color-bg-primary)] p-6 rounded-2xl shadow-lg mb-16",children:[e.jsx("div",{className:"flex items-center justify-between mb-6",children:e.jsxs("div",{className:"flex space-x-3",children:[e.jsx("button",{onClick:e=>{e.preventDefault(),ae.current=window.scrollY,J("description")},className:"px-4 py-2 rounded-lg font-semibold transition "+("description"===G?"bg-[var(--color-accent-primary)] text-white":"bg-[var(--color-bg-section)] text-[var(--color-text-primary)] hover:bg-[var(--color-border-light)]"),children:"Product Description"}),e.jsxs("button",{onClick:e=>{e.preventDefault(),ae.current=window.scrollY,J("reviews")},className:"px-4 py-2 rounded-lg font-semibold transition "+("reviews"===G?"bg-[var(--color-accent-primary)] text-white":"bg-[var(--color-bg-section)] text-[var(--color-text-primary)] hover:bg-[var(--color-border-light)]"),children:["Reviews (",w.numReviews||w.reviews?.length||0,")"]})]})}),"description"===G?e.jsx("div",{children:e.jsx("div",{className:"prose prose-sm max-w-none text-[var(--color-text-light)] leading-relaxed mb-8",dangerouslySetInnerHTML:{__html:w.description||""}})}):e.jsx("div",{className:"p-0",children:e.jsx(b,{product:w,token:oe,user:ne,onSubmitReview:async e=>{if(!oe)throw o.error("Please log in to submit a review"),new Error("Not authenticated");try{ae.current=window.scrollY;const t=w?._id||v||y;if(!t)throw new Error("Product identifier missing");const r=await fetch(`${de}/api/products/${t}/reviews`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${oe}`},body:JSON.stringify(e)}),s=await r.json();if(!r.ok)throw new Error(s.message||"Failed to submit review");o.success("Review submitted successfully"),w&&w._id?N(d(w._id)):N(d(t))}catch(t){throw ae.current=0,t}},requireReviewApproval:le,API:de})})]}),w&&e.jsx(p,{currentProductId:w._id,currentCategory:w.category,limit:5}),Q&&me.length>0&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-90 z-50 flex items-center justify-center p-4",onClick:()=>X(!1),children:e.jsxs("div",{className:"relative w-full max-w-5xl flex items-center justify-center gap-6",onClick:e=>e.stopPropagation(),children:[e.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center",children:[e.jsxs("div",{ref:se,className:"relative bg-white rounded-lg overflow-hidden shadow-2xl cursor-crosshair",onMouseMove:e=>{if(!se.current)return;const t=se.current.getBoundingClientRect(),r=e.clientX-t.left,s=e.clientY-t.top;re({x:r,y:s})},onMouseLeave:()=>re({x:0,y:0}),style:{maxWidth:"500px",maxHeight:"500px"},children:[e.jsx("img",{src:xe(me[Z]),alt:`${w.name} zoom`,className:"w-full h-full object-contain",onError:e=>{e.target.style.opacity="0"}},`zoom-main-${Z}`),e.jsx("div",{className:"absolute w-20 h-20 border-4 border-yellow-400 rounded-full pointer-events-none shadow-lg",style:{left:te.x-40+"px",top:te.y-40+"px",opacity:te.x>0||te.y>0?1:0,transition:"opacity 0.2s"}})]}),me.length>1&&e.jsxs("div",{className:"flex gap-3 m-5 justify-center",children:[e.jsx("button",{onClick:e=>{e.stopPropagation(),ee(e=>(e-1+me.length)%me.length)},className:"bg-[var(--color-bg-primary)] hover:bg-[var(--color-bg-section)] text-[var(--color-text-primary)] rounded-full p-3 shadow-lg transition","aria-label":"Previous image",children:e.jsx("i",{className:"fas fa-arrow-left",style:{fontSize:"18px"}})}),e.jsx("div",{className:"bg-[var(--color-accent-primary)] bg-opacity-60 text-white px-4 py-2 rounded-full flex items-center justify-center min-w-20",children:e.jsxs("span",{className:"font-semibold",children:[Z+1," / ",me.length]})}),e.jsx("button",{onClick:e=>{e.stopPropagation(),ee(e=>(e+1)%me.length)},className:"bg-[var(--color-bg-primary)] hover:bg-[var(--color-bg-section)] text-[var(--color-text-primary)] rounded-full p-3 shadow-lg transition","aria-label":"Next image",children:e.jsx("i",{className:"fas fa-arrow-right",style:{fontSize:"18px"}})})]})]}),e.jsx("div",{className:"flex-1 flex flex-col justify-center items-center gap-4",children:e.jsxs("div",{className:"relative bg-[var(--color-bg-primary)] rounded-lg overflow-hidden shadow-2xl border-4 border-[var(--color-border-light)]",style:{width:"300px",height:"300px"},children:[e.jsx("img",{src:xe(me[Z]),alt:`${w.name} magnified`,className:"absolute w-full h-full object-contain",style:{transform:"scale(2.5)",transformOrigin:`${te.x/(se.current?.offsetWidth||1)*100}% ${te.y/(se.current?.offsetHeight||1)*100}%`,transition:"transform 0.1s ease-out"},onError:e=>{e.target.style.opacity="0"}},`zoom-magnified-${Z}`),0===te.x&&0===te.y&&e.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-[var(--color-bg-section)] bg-opacity-50",children:e.jsx("p",{className:"text-[var(--color-text-light)] text-center font-semibold",children:"Move mouse over image to zoom"})})]})}),e.jsx("button",{onClick:()=>X(!1),className:"absolute top-4 right-4 bg-[var(--color-bg-primary)] bg-opacity-80 hover:bg-opacity-100 text-[var(--color-text-primary)] rounded-full p-3 shadow-lg transition","aria-label":"Close zoom",children:e.jsx("span",{className:"text-xl font-bold",children:"âœ•"})})]})})]})]})};export{v as default};
