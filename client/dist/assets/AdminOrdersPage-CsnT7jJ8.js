import{j as e}from"./editor-BiSlXHWs.js";import{a as r}from"./vendor-0z5P9xg-.js";import{A as t}from"./AdminLayout-Cnhsu9ug.js";import{u as l,d as o}from"./redux-DhaBhdiE.js";import{q as s,z as a}from"./index-BiO51Ilc.js";const i="https://api.wolfsupplies.co.uk",d=e=>{if(!e)return"";if("string"==typeof e)return e.trim()?e.startsWith("http")?e:`${i}${e}`:"";if("object"==typeof e){const r=e.url||e.secure_url||e.public_url||e.path||e.src||"";if(!r)return"";if("string"==typeof r)return r.startsWith("http")?r:`${i}${r}`}return""},c=()=>{const t=l(),{orders:c=[],loading:n}=o(e=>e.order),[x,m]=r.useState([]),[p,h]=r.useState([]),[u,g]=r.useState(!1),[y,b]=r.useState(null),[f,v]=r.useState(!1),[j,N]=r.useState(""),[C,w]=r.useState(null),[k,S]=r.useState(!1),[A,B]=r.useState(!1),[$,D]=r.useState(!1),[O,F]=r.useState({}),[R,_]=r.useState({}),[E,T]=r.useState({}),[P,I]=r.useState("all"),[z,L]=r.useState("");r.useEffect(()=>{t(s())},[t]),r.useEffect(()=>{const e=c||[];m(e),h(r=>r.filter(r=>e.some(e=>e._id===r))),g(r=>e.length>0&&r.length===e.length)},[c]);const U=(()=>{let e=x;if("all"===P||("fulfilled"===P?e=e.filter(e=>"fulfilled"===e.fulfillmentStatus):"unfulfilled"===P?e=e.filter(e=>"unfulfilled"===e.fulfillmentStatus):"shipped"===P?e=e.filter(e=>"shipped"===e.deliveryStatus):"delivered"===P?e=e.filter(e=>"delivered"===e.deliveryStatus):"refunded"===P&&(e=e.filter(e=>"refunded"===e.deliveryStatus))),z.trim()){const r=z.trim().toLowerCase();e=e.filter(e=>{const t=e.orderId||`ORD-${new Date(e.createdAt).toISOString().slice(0,10).replace(/-/g,"")}-${e._id?.slice(-6)}`,l=(e.totalPrice??e.totalAmount??0).toString();return t.toLowerCase().includes(r)||l.includes(r)||e._id.toLowerCase().includes(r)})}return e})();return e.jsxs("div",{children:[n&&e.jsx("div",{className:"flex justify-center items-center py-12",children:e.jsx("i",{className:"fas fa-spinner animate-spin text-4xl text-gray-700"})}),!n&&e.jsxs("div",{className:"bg-white rounded-lg shadow-lg overflow-hidden",children:[e.jsxs("div",{className:"px-6 py-4 bg-white border-b flex gap-2 overflow-x-auto",children:[e.jsx("button",{onClick:()=>I("all"),className:"px-4 py-2 rounded-full font-semibold text-sm whitespace-nowrap transition "+("all"===P?"bg-indigo-600 text-white":"bg-gray-100 text-gray-800 hover:bg-gray-200"),children:"All Orders"}),e.jsx("button",{onClick:()=>I("fulfilled"),className:"px-4 py-2 rounded-full font-semibold text-sm whitespace-nowrap transition "+("fulfilled"===P?"bg-green-600 text-white":"bg-gray-100 text-gray-800 hover:bg-gray-200"),children:"Fulfilled"}),e.jsx("button",{onClick:()=>I("unfulfilled"),className:"px-4 py-2 rounded-full font-semibold text-sm whitespace-nowrap transition "+("unfulfilled"===P?"bg-yellow-600 text-white":"bg-gray-100 text-gray-800 hover:bg-gray-200"),children:"Unfulfilled"}),e.jsx("button",{onClick:()=>I("shipped"),className:"px-4 py-2 rounded-full font-semibold text-sm whitespace-nowrap transition "+("shipped"===P?"bg-orange-600 text-white":"bg-gray-100 text-gray-800 hover:bg-gray-200"),children:"Shipped"}),e.jsx("button",{onClick:()=>I("delivered"),className:"px-4 py-2 rounded-full font-semibold text-sm whitespace-nowrap transition "+("delivered"===P?"bg-blue-600 text-white":"bg-gray-100 text-gray-800 hover:bg-gray-200"),children:"Delivered"}),e.jsx("button",{onClick:()=>I("refunded"),className:"px-4 py-2 rounded-full font-semibold text-sm whitespace-nowrap transition "+("refunded"===P?"bg-red-600 text-white":"bg-gray-100 text-gray-800 hover:bg-gray-200"),children:"Refunded"})]}),e.jsxs("div",{className:"px-6 py-4 bg-gray-50 border-b flex justify-between items-center gap-4 flex-wrap",children:[e.jsxs("h3",{className:"font-semibold text-gray-900",children:["Orders (",U.length,")"]}),e.jsxs("div",{className:"flex items-center gap-3 flex-wrap",children:[e.jsx("input",{type:"text",placeholder:"Search by Order ID or Price...",value:z,onChange:e=>L(e.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-indigo-500",style:{minWidth:"250px"}}),e.jsxs("button",{onClick:()=>t(s()),className:"text-gray-700 hover:text-indigo-800 flex items-center gap-2",title:"Refresh orders",children:[e.jsx("i",{className:"fas fa-sync"})," Refresh"]}),e.jsx("button",{onClick:async()=>{if(0===p.length)return a("No orders selected");if(confirm("Delete selected orders that are fulfilled and delivered? This cannot be undone.")){v(!0);try{const e=localStorage.getItem("token"),r=x.filter(e=>p.includes(e._id));if(0===r.length)return a("No selected orders to delete"),void v(!1);await Promise.all(r.map(r=>fetch(`${i}/api/orders/${r._id}`,{method:"DELETE",headers:{Authorization:`Bearer ${e}`}}))),a.success(`Deleted ${r.length} orders`),h([]),g(!1),t(s())}catch(e){a.error("Bulk delete failed")}finally{v(!1)}}},className:"px-3 py-1 bg-red-600 text-white rounded flex items-center gap-2",title:"Delete selected fulfilled+delivered",children:f?e.jsx("i",{className:"fas fa-spinner animate-spin"}):"Delete Selected"})]})]}),e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-100 border-b",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-900",children:e.jsx("input",{type:"checkbox",checked:u,onChange:e=>{const r=e.target.checked;g(r),h(r?(U||[]).map(e=>e._id):[])}})}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-900",children:"Order / Date"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-900",children:"Coupon"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-900",children:"Total Price"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-900",children:"Fulfilment"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-900",children:"Delivery Status"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-900",children:"Action"})]})}),e.jsx("tbody",{className:"divide-y",children:U&&U.length>0?U.map(r=>{const l=r.orderId||`ORD-${new Date(r.createdAt).toISOString().slice(0,10).replace(/-/g,"")}-${r._id?.slice(-6)}`;!r.createdAt||new Date(r.createdAt).toLocaleDateString();const o=r.createdAt?new Date(r.createdAt).toLocaleString():"N/A",d=r.totalPrice??r.totalAmount??0,c="fulfilled"===r.fulfillmentStatus,n=r.deliveryStatus||"";return e.jsxs("tr",{className:"hover:bg-gray-50 transition duration-300",children:[e.jsx("td",{className:"px-4 py-4",children:e.jsx("input",{type:"checkbox",checked:p.includes(r._id),onChange:e=>{const t=e.target.checked;h(e=>t?[...e,r._id]:e.filter(e=>e!==r._id)),t||g(!1)}})}),e.jsxs("td",{className:"px-4 py-4 font-mono text-gray-900 text-sm",children:[l," ",e.jsx("br",{}),o," "]}),e.jsx("td",{className:"px-4 py-4 text-gray-700 text-sm",children:r.couponCode?e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:r.couponCode}),e.jsx("br",{}),e.jsxs("span",{className:"text-green-600",children:["-Â£",(r.discountAmount||0).toFixed(2)]})]}):e.jsx("span",{className:"text-gray-400",children:"â€”"})}),e.jsxs("td",{className:"px-4 py-4 text-gray-700 font-bold",children:["Â£",Number(d).toFixed(2)]}),e.jsx("td",{className:"px-4 py-4",children:e.jsx("button",{onClick:()=>(async(e,r)=>{try{const l=localStorage.getItem("token"),o=r?"fulfilled":"unfulfilled";if(!(await fetch(`${i}/api/orders/${e}/fulfillment`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${l}`},body:JSON.stringify({fulfillmentStatus:o})})).ok)throw new Error("Failed to update fulfillment status");a.success(`Order marked as ${o}`),t(s())}catch(l){a.error(l.message)}})(r._id,!c),className:"px-3 py-1 rounded-full text-sm font-semibold "+(c?"bg-gray-100 text-gray-800":"bg-red-100 text-red-800"),title:c?"Fulfilled - click to mark unfulfilled":"Unfulfilled - click to mark fulfilled",children:c?"Fulfilled":"Unfulfilled"})}),e.jsx("td",{className:"px-4 py-4",children:e.jsxs("select",{value:n,onChange:e=>(async(e,r)=>{try{const l=localStorage.getItem("token");if(!(await fetch(`${i}/api/orders/${e}/delivery`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${l}`},body:JSON.stringify({deliveryStatus:r})})).ok)throw new Error("Failed to update delivery status");const o={"":"Status cleared",shipped:"Order marked as shipped",delivered:"Order marked as delivered",refunded:"Order marked as refunded"};a.success(o[r]||"Status updated"),t(s())}catch(l){a.error(l.message)}})(r._id,e.target.value),className:"px-3 py-1 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-indigo-500",children:[e.jsx("option",{value:"",children:"No Status"}),e.jsx("option",{value:"shipped",children:"shipped"}),e.jsx("option",{value:"delivered",children:"Delivered"}),e.jsx("option",{value:"refunded",children:"Refunded"})]})}),e.jsx("td",{className:"px-4 py-4",children:e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs("button",{onClick:()=>b(r),className:"px-3 py-1 bg-gray-800 text-white rounded text-sm",children:[" ",e.jsx("i",{className:"fas fa-file"})," "]})})})]},r._id)}):e.jsx("tr",{children:e.jsx("td",{colSpan:"8",className:"px-6 py-8 text-center text-gray-600",children:"No orders found"})})})]})]}),y&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50 p-4",children:e.jsxs("div",{className:"bg-white max-w-6xl w-full rounded-lg shadow-2xl overflow-auto max-h-[90vh] grid grid-cols-1 md:grid-cols-3 gap-0",style:{backgroundColor:"var(--color-bg-primary, #ffffff)"},children:[e.jsxs("div",{className:"md:col-span-2 flex flex-col overflow-auto",children:[e.jsxs("div",{className:"sticky top-0 z-10 flex justify-between items-center p-6 border-b",style:{borderColor:"var(--color-border-light, #e5e5e5)",backgroundColor:"var(--color-bg-primary, #ffffff)"},children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"text-xl font-bold",style:{color:"var(--color-text-primary, #000000)"},children:["Order ",y.orderId||y._id]}),e.jsx("p",{className:"text-sm mt-1",style:{color:"var(--color-text-light, #6B6B6B)"},children:new Date(y.createdAt).toLocaleDateString()})]}),e.jsx("button",{onClick:()=>{b(null),N(""),w(null),S(!1),B(!1),D(!1)},className:"px-4 py-2 rounded font-semibold transition-all hover:opacity-75",style:{backgroundColor:"var(--color-bg-section, #e5e5e5)",color:"var(--color-text-primary, #000000)"},children:"Close"})]}),e.jsxs("div",{className:"p-6 space-y-6 overflow-auto flex-1",children:[e.jsxs("div",{className:"p-6 rounded-lg border-2",style:{backgroundColor:"var(--color-bg-section, #e5e5e5)",borderColor:"var(--color-border-light, #e5e5e5)"},children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h4",{className:"text-lg font-semibold",style:{color:"var(--color-text-primary, #000000)"},children:"Contact Details"}),!k&&e.jsx("button",{onClick:()=>{S(!0),F({firstName:y.contactDetails?.firstName||y.user?.name?.split(" ")[0]||"",lastName:y.contactDetails?.lastName||y.user?.name?.split(" ")[1]||"",email:y.contactDetails?.email||y.user?.email||"",phone:y.contactDetails?.phone||""})},className:"px-3 py-1 rounded text-xs font-semibold text-white",style:{backgroundColor:"#4f46e5"},children:"Edit"})]}),k?e.jsxs("div",{className:"space-y-3",children:[e.jsx("input",{type:"text",placeholder:"First Name",value:O.firstName||"",onChange:e=>F({...O,firstName:e.target.value}),className:"w-full p-2 rounded border text-sm",style:{borderColor:"var(--color-border-light, #e5e5e5)",backgroundColor:"white",color:"var(--color-text-primary, #000000)"}}),e.jsx("input",{type:"text",placeholder:"Last Name",value:O.lastName||"",onChange:e=>F({...O,lastName:e.target.value}),className:"w-full p-2 rounded border text-sm",style:{borderColor:"var(--color-border-light, #e5e5e5)",backgroundColor:"white",color:"var(--color-text-primary, #000000)"}}),e.jsx("input",{type:"email",placeholder:"Email",value:O.email||"",onChange:e=>F({...O,email:e.target.value}),className:"w-full p-2 rounded border text-sm",style:{borderColor:"var(--color-border-light, #e5e5e5)",backgroundColor:"white",color:"var(--color-text-primary, #000000)"}}),e.jsx("input",{type:"tel",placeholder:"Phone",value:O.phone||"",onChange:e=>F({...O,phone:e.target.value}),className:"w-full p-2 rounded border text-sm",style:{borderColor:"var(--color-border-light, #e5e5e5)",backgroundColor:"white",color:"var(--color-text-primary, #000000)"}}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:async()=>{try{const e=localStorage.getItem("token");if(!(await fetch(`${i}/api/orders/${y._id}/contact`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`},body:JSON.stringify({contactDetails:O})})).ok)throw new Error("Failed to update contact details");a.success("Contact details updated"),S(!1),t(s())}catch(e){a.error(e.message)}},className:"flex-1 px-2 py-2 rounded text-xs font-semibold text-white",style:{backgroundColor:"var(--color-accent-primary, #a5632a)"},children:"Save"}),e.jsx("button",{onClick:()=>S(!1),className:"flex-1 px-2 py-2 rounded text-xs font-semibold text-white",style:{backgroundColor:"#6b7280"},children:"Cancel"})]})]}):e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs mb-1 font-semibold",style:{color:"var(--color-text-light, #6B6B6B)"},children:"First Name"}),e.jsx("p",{style:{color:"var(--color-text-primary, #000000)"},children:O.firstName||y.contactDetails?.firstName||y.user?.name?.split(" ")[0]||"N/A"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs mb-1 font-semibold",style:{color:"var(--color-text-light, #6B6B6B)"},children:"Last Name"}),e.jsx("p",{style:{color:"var(--color-text-primary, #000000)"},children:O.lastName||y.contactDetails?.lastName||y.user?.name?.split(" ")[1]||"N/A"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs mb-1 font-semibold",style:{color:"var(--color-text-light, #6B6B6B)"},children:"Email"}),e.jsx("p",{style:{color:"var(--color-text-primary, #000000)"},children:O.email||y.contactDetails?.email||y.user?.email||"N/A"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs mb-1 font-semibold",style:{color:"var(--color-text-light, #6B6B6B)"},children:"Phone"}),e.jsx("p",{style:{color:"var(--color-text-primary, #000000)"},children:O.phone||y.contactDetails?.phone||"N/A"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"p-4 rounded-lg border-2",style:{backgroundColor:"var(--color-bg-section, #e5e5e5)",borderColor:"var(--color-border-light, #e5e5e5)"},children:[e.jsxs("div",{className:"flex justify-between items-center mb-3",children:[e.jsx("h4",{className:"font-semibold",style:{color:"var(--color-text-primary, #000000)"},children:"Shipping Address"}),!A&&e.jsx("button",{onClick:()=>{B(!0),_(y.shippingAddress||{})},className:"px-2 py-1 rounded text-xs font-semibold text-white",style:{backgroundColor:"#4f46e5"},children:"Edit"})]}),A?e.jsxs("div",{className:"space-y-2",children:[e.jsx("input",{type:"text",placeholder:"Address",value:R.address||"",onChange:e=>_({...R,address:e.target.value}),className:"w-full p-2 rounded border text-sm",style:{borderColor:"var(--color-border-light, #e5e5e5)",backgroundColor:"white",color:"var(--color-text-primary, #000000)"}}),e.jsx("input",{type:"text",placeholder:"Apartment / Suite (Optional)",value:R.apartment||"",onChange:e=>_({...R,apartment:e.target.value}),className:"w-full p-2 rounded border text-sm",style:{borderColor:"var(--color-border-light, #e5e5e5)",backgroundColor:"white",color:"var(--color-text-primary, #000000)"}}),e.jsx("input",{type:"text",placeholder:"City",value:R.city||"",onChange:e=>_({...R,city:e.target.value}),className:"w-full p-2 rounded border text-sm",style:{borderColor:"var(--color-border-light, #e5e5e5)",backgroundColor:"white",color:"var(--color-text-primary, #000000)"}}),e.jsx("input",{type:"text",placeholder:"State / Region (Optional)",value:R.stateRegion||"",onChange:e=>_({...R,stateRegion:e.target.value}),className:"w-full p-2 rounded border text-sm",style:{borderColor:"var(--color-border-light, #e5e5e5)",backgroundColor:"white",color:"var(--color-text-primary, #000000)"}}),e.jsx("input",{type:"text",placeholder:"Postal Code",value:R.postalCode||"",onChange:e=>_({...R,postalCode:e.target.value}),className:"w-full p-2 rounded border text-sm",style:{borderColor:"var(--color-border-light, #e5e5e5)",backgroundColor:"white",color:"var(--color-text-primary, #000000)"}}),e.jsx("input",{type:"text",placeholder:"Country",value:R.country||"",onChange:e=>_({...R,country:e.target.value}),className:"w-full p-2 rounded border text-sm",style:{borderColor:"var(--color-border-light, #e5e5e5)",backgroundColor:"white",color:"var(--color-text-primary, #000000)"}}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:async()=>{try{const e=localStorage.getItem("token");if(!(await fetch(`${i}/api/orders/${y._id}/shipping`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`},body:JSON.stringify({shippingAddress:R})})).ok)throw new Error("Failed to update shipping address");a.success("Shipping address updated"),B(!1),t(s())}catch(e){a.error(e.message)}},className:"flex-1 px-2 py-1 rounded text-xs font-semibold text-white",style:{backgroundColor:"var(--color-accent-primary, #a5632a)"},children:"Save"}),e.jsx("button",{onClick:()=>B(!1),className:"flex-1 px-2 py-1 rounded text-xs font-semibold text-white",style:{backgroundColor:"#6b7280"},children:"Cancel"})]})]}):e.jsx(e.Fragment,{children:y.shippingAddress?e.jsxs("div",{className:"text-sm space-y-1",style:{color:"var(--color-text-primary, #000000)"},children:[e.jsx("div",{className:"font-semibold",children:R.address||y.shippingAddress.address}),(R.apartment||y.shippingAddress.apartment)&&e.jsx("div",{children:R.apartment||y.shippingAddress.apartment}),e.jsxs("div",{children:[R.city||y.shippingAddress.city,R.stateRegion||y.shippingAddress.stateRegion?`, ${R.stateRegion||y.shippingAddress.stateRegion}`:""," ",R.postalCode||y.shippingAddress.postalCode]}),e.jsx("div",{children:R.country||y.shippingAddress.country})]}):e.jsx("div",{className:"text-sm",style:{color:"var(--color-text-light, #6B6B6B)"},children:"No shipping address provided."})})]}),e.jsxs("div",{className:"p-4 rounded-lg border-2",style:{backgroundColor:"var(--color-bg-section, #e5e5e5)",borderColor:"var(--color-border-light, #e5e5e5)"},children:[e.jsxs("div",{className:"flex justify-between items-center mb-3",children:[e.jsx("h4",{className:"font-semibold",style:{color:"var(--color-text-primary, #000000)"},children:"Billing Address"}),!$&&e.jsx("button",{onClick:()=>{D(!0),T(y.billingAddress||{})},className:"px-2 py-1 rounded text-xs font-semibold text-white",style:{backgroundColor:"#4f46e5"},children:"Edit"})]}),$?e.jsxs("div",{className:"space-y-2",children:[e.jsx("input",{type:"text",placeholder:"Address",value:E.address||"",onChange:e=>T({...E,address:e.target.value}),className:"w-full p-2 rounded border text-sm",style:{borderColor:"var(--color-border-light, #e5e5e5)",backgroundColor:"white",color:"var(--color-text-primary, #000000)"}}),e.jsx("input",{type:"text",placeholder:"Apartment / Suite (Optional)",value:E.apartment||"",onChange:e=>T({...E,apartment:e.target.value}),className:"w-full p-2 rounded border text-sm",style:{borderColor:"var(--color-border-light, #e5e5e5)",backgroundColor:"white",color:"var(--color-text-primary, #000000)"}}),e.jsx("input",{type:"text",placeholder:"City",value:E.city||"",onChange:e=>T({...E,city:e.target.value}),className:"w-full p-2 rounded border text-sm",style:{borderColor:"var(--color-border-light, #e5e5e5)",backgroundColor:"white",color:"var(--color-text-primary, #000000)"}}),e.jsx("input",{type:"text",placeholder:"State / Region (Optional)",value:E.stateRegion||"",onChange:e=>T({...E,stateRegion:e.target.value}),className:"w-full p-2 rounded border text-sm",style:{borderColor:"var(--color-border-light, #e5e5e5)",backgroundColor:"white",color:"var(--color-text-primary, #000000)"}}),e.jsx("input",{type:"text",placeholder:"Postal Code",value:E.postalCode||"",onChange:e=>T({...E,postalCode:e.target.value}),className:"w-full p-2 rounded border text-sm",style:{borderColor:"var(--color-border-light, #e5e5e5)",backgroundColor:"white",color:"var(--color-text-primary, #000000)"}}),e.jsx("input",{type:"text",placeholder:"Country",value:E.country||"",onChange:e=>T({...E,country:e.target.value}),className:"w-full p-2 rounded border text-sm",style:{borderColor:"var(--color-border-light, #e5e5e5)",backgroundColor:"white",color:"var(--color-text-primary, #000000)"}}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:async()=>{try{const e=localStorage.getItem("token");if(!(await fetch(`${i}/api/orders/${y._id}/billing`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`},body:JSON.stringify({billingAddress:E})})).ok)throw new Error("Failed to update billing address");a.success("Billing address updated"),D(!1),t(s())}catch(e){a.error(e.message)}},className:"flex-1 px-2 py-1 rounded text-xs font-semibold text-white",style:{backgroundColor:"var(--color-accent-primary, #a5632a)"},children:"Save"}),e.jsx("button",{onClick:()=>D(!1),className:"flex-1 px-2 py-1 rounded text-xs font-semibold text-white",style:{backgroundColor:"#6b7280"},children:"Cancel"})]})]}):e.jsx(e.Fragment,{children:y.billingAddress?e.jsxs("div",{className:"text-sm space-y-1",style:{color:"var(--color-text-primary, #000000)"},children:[e.jsx("div",{className:"font-semibold",children:E.address||y.billingAddress.address}),(E.apartment||y.billingAddress.apartment)&&e.jsx("div",{children:E.apartment||y.billingAddress.apartment}),e.jsxs("div",{children:[E.city||y.billingAddress.city,E.stateRegion||y.billingAddress.stateRegion?`, ${E.stateRegion||y.billingAddress.stateRegion}`:""," ",E.postalCode||y.billingAddress.postalCode]}),e.jsx("div",{children:E.country||y.billingAddress.country})]}):e.jsx("div",{className:"text-sm",style:{color:"var(--color-text-light, #6B6B6B)"},children:"Same as shipping"})})]})]}),e.jsxs("div",{className:"p-4 rounded-lg border-2",style:{backgroundColor:"white",borderColor:"var(--color-border-light, #e5e5e5)"},children:[e.jsx("h4",{className:"font-semibold mb-4",style:{color:"var(--color-text-primary, #000000)"},children:"Order Items"}),e.jsx("div",{className:"space-y-4",children:y.orderItems?.map(r=>{const t=[];r.selectedVariants&&"object"==typeof r.selectedVariants&&Object.entries(r.selectedVariants).forEach(([e,r])=>{r&&t.push(`${e}: ${r}`)}),r.selectedSize&&!t.some(e=>e.toLowerCase().includes("size"))&&t.push(`Size: ${r.selectedSize}`),r.selectedColor&&!t.some(e=>e.toLowerCase().includes("color"))&&t.push(`Color: ${r.selectedColor}`);const l=t.join(" / ");return e.jsxs("div",{className:"flex gap-3 sm:gap-4 pb-4 border-b",style:{borderColor:"var(--color-border-light, #e5e5e5)"},children:[e.jsx("div",{className:"shrink-0",children:e.jsx("img",{src:d(r.image),alt:r.name,className:"w-full h-full sm:w-20 sm:h-20 object-contain rounded border",style:{borderColor:"var(--color-border-light, #e5e5e5)"}})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"font-bold text-sm sm:text-base mb-1",style:{color:"var(--color-text-primary, #000000)"},children:r.name}),l&&e.jsx("p",{className:"text-xs sm:text-sm mb-1",style:{color:"var(--color-text-light, #6B6B6B)"},children:l}),r.sku&&e.jsxs("p",{className:"text-xs mb-1",style:{color:"var(--color-text-light, #6B6B6B)"},children:["SKU: ",r.sku]}),e.jsxs("p",{className:"text-xs sm:text-sm",style:{color:"var(--color-text-secondary, #3a3a3a)"},children:["Qty: ",r.qty," Ã— Â£",Number(r.price).toFixed(2)]})]}),e.jsx("div",{className:"text-right flex-shrink-0",children:e.jsxs("p",{className:"font-bold text-base sm:text-lg",style:{color:"var(--color-accent-primary, #a5632a)"},children:["Â£",(r.qty*r.price).toFixed(2)]})})]},r._id||r.product)})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"p-4 rounded-lg border-2",style:{backgroundColor:"white",borderColor:"var(--color-border-light, #e5e5e5)"},children:[e.jsx("h4",{className:"font-semibold mb-3",style:{color:"var(--color-text-primary, #000000)"},children:"Order Summary"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{style:{color:"var(--color-text-secondary, #3a3a3a)"},children:"Items:"}),e.jsxs("span",{className:"font-semibold",style:{color:"var(--color-text-primary, #000000)"},children:["Â£",((y.itemsPrice??y.orderItems?.reduce((e,r)=>e+r.price*r.qty,0))||0).toFixed(2)]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{style:{color:"var(--color-text-secondary, #3a3a3a)"},children:"Shipping:"}),e.jsxs("span",{className:"font-semibold",style:{color:"var(--color-text-primary, #000000)"},children:["Â£",(y.shippingPrice||0).toFixed(2)]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{style:{color:"var(--color-text-secondary, #3a3a3a)"},children:"Tax:"}),e.jsxs("span",{className:"font-semibold",style:{color:"var(--color-text-primary, #000000)"},children:["Â£",(y.taxPrice||0).toFixed(2)]})]}),y.discountAmount>0&&y.couponCode&&e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("span",{style:{color:"var(--color-text-secondary, #3a3a3a)"},children:["Discount (",y.couponCode,"):"]}),e.jsxs("span",{className:"font-semibold",style:{color:"#10b981"},children:["-Â£",(y.discountAmount||0).toFixed(2)]})]}),e.jsxs("div",{className:"border-t pt-2 flex justify-between font-bold",style:{borderColor:"var(--color-border-light, #e5e5e5)",color:"var(--color-accent-primary, #a5632a)"},children:[e.jsx("span",{children:"Total:"}),e.jsxs("span",{children:["Â£",(y.totalPrice||y.totalAmount||0).toFixed(2)]})]})]})]}),e.jsxs("div",{className:"p-4 rounded-lg border-2",style:{backgroundColor:"white",borderColor:"var(--color-border-light, #e5e5e5)"},children:[e.jsx("h4",{className:"font-semibold mb-3",style:{color:"var(--color-text-primary, #000000)"},children:"Fulfillment"}),e.jsx("div",{className:"px-3 py-2 rounded text-sm font-semibold",style:{backgroundColor:"completed"===y.status?"var(--color-accent-primary, #a5632a)":"var(--color-bg-section, #e5e5e5)",color:"completed"===y.status?"white":"var(--color-text-primary, #000000)"},children:"completed"===y.status?"âœ“ Fulfilled":"â³ Unfulfilled"})]}),e.jsxs("div",{className:"p-4 rounded-lg border-2",style:{backgroundColor:"white",borderColor:"var(--color-border-light, #e5e5e5)"},children:[e.jsx("h4",{className:"font-semibold mb-3",style:{color:"var(--color-text-primary, #000000)"},children:"Delivery"}),e.jsx("div",{className:"px-3 py-2 rounded text-sm font-semibold",style:{backgroundColor:"refunded"===y.deliveryStatus?"#dc2626":"delivered"===y.deliveryStatus?"var(--color-accent-primary, #a5632a)":"shipped"===y.deliveryStatus?"#d4905e":"var(--color-bg-section, #e5e5e5)",color:y.deliveryStatus?"white":"var(--color-text-primary, #000000)"},children:"refunded"===y.deliveryStatus?"âš ï¸ Refunded":"delivered"===y.deliveryStatus?"âœ“ Delivered":"shipped"===y.deliveryStatus?"ðŸ“¦ Shipped":"â³ No Status"})]})]})]})]}),e.jsxs("div",{className:"md:col-span-1 border-l flex flex-col overflow-auto",style:{borderColor:"var(--color-border-light, #e5e5e5)",backgroundColor:"var(--color-bg-section, #e5e5e5)"},children:[e.jsx("div",{className:"sticky top-0 z-10 p-6 border-b",style:{borderColor:"var(--color-border-light, #e5e5e5)",backgroundColor:"var(--color-bg-section, #e5e5e5)"},children:e.jsx("h4",{className:"text-sm font-bold uppercase tracking-wide",style:{color:"var(--color-text-light, #6B6B6B)"},children:"Overview"})}),e.jsxs("div",{className:"p-6 space-y-6 flex-1 overflow-auto",children:[e.jsxs("div",{className:"p-4 rounded-lg border-2",style:{backgroundColor:"white",borderColor:"var(--color-border-light, #e5e5e5)"},children:[e.jsx("p",{className:"text-xs mb-2 font-semibold",style:{color:"var(--color-text-light, #6B6B6B)"},children:"Total Orders From this Customer"}),e.jsx("p",{className:"text-3xl font-bold",style:{color:"var(--color-accent-primary, #a5632a)"},children:x.filter(e=>e.user===y.user||e.user?._id===y.user?._id).length})]}),e.jsxs("div",{className:"p-4 rounded-lg border-2",style:{backgroundColor:"white",borderColor:"var(--color-border-light, #e5e5e5)"},children:[e.jsx("p",{className:"text-xs mb-3 font-semibold",style:{color:"var(--color-text-light, #6B6B6B)"},children:"REMARKS"}),e.jsxs("div",{className:"border rounded mb-4",style:{borderColor:"var(--color-border-light, #e5e5e5)"},children:[e.jsx("textarea",{placeholder:"Add notes or remarks about this order...",className:"w-full p-3 text-sm resize-none focus:outline-none",style:{color:"var(--color-text-primary, #000000)",backgroundColor:"var(--color-bg-primary, #ffffff)",borderBottom:"1px solid var(--color-border-light, #e5e5e5)"},rows:"4",value:j,onChange:e=>N(e.target.value)}),e.jsx("button",{className:"w-full px-3 py-2 font-semibold text-white text-sm transition-all hover:opacity-90",style:{backgroundColor:"var(--color-accent-primary, #a5632a)"},onClick:async()=>{if(j.trim())try{const e=localStorage.getItem("token");if(!(await fetch(`${i}/api/orders/${y._id}/remarks`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`},body:JSON.stringify({remarks:j})})).ok)throw new Error("Failed to save remarks");a.success("Remarks saved"),N(""),t(s())}catch(e){a.error(e.message)}else a.error("Please enter a remark")},children:"Save Remarks"})]}),y.remarks&&e.jsxs("div",{className:"p-3 rounded",style:{backgroundColor:"var(--color-bg-section, #e5e5e5)",borderLeft:"4px solid var(--color-accent-primary, #a5632a)"},children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsx("p",{className:"text-xs font-semibold",style:{color:"var(--color-text-light, #6B6B6B)"},children:"SAVED REMARK"}),e.jsxs("p",{className:"text-xs",style:{color:"var(--color-text-light, #6B6B6B)"},children:[new Date(y.updatedAt).toLocaleDateString()," ",new Date(y.updatedAt).toLocaleTimeString()]})]}),e.jsx("p",{className:"text-sm mb-3",style:{color:"var(--color-text-primary, #000000)"},children:y.remarks}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{className:"flex-1 px-2 py-1 rounded text-xs font-semibold text-white transition-all hover:opacity-90",style:{backgroundColor:"#4f46e5"},onClick:()=>{N(y.remarks),w(y._id)},children:"Edit"}),e.jsx("button",{className:"flex-1 px-2 py-1 rounded text-xs font-semibold text-white transition-all hover:opacity-90",style:{backgroundColor:"#dc2626"},onClick:async()=>{if(confirm("Delete this remark?"))try{const e=localStorage.getItem("token");if(!(await fetch(`${i}/api/orders/${y._id}/remarks`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`},body:JSON.stringify({remarks:""})})).ok)throw new Error("Failed to delete remarks");a.success("Remarks deleted"),N(""),t(s())}catch(e){a.error(e.message)}},children:"Delete"})]})]})]})]})]})]})})]})},n=()=>e.jsx(t,{activeTab:"orders",children:e.jsxs("div",{className:"p-8",children:[e.jsx("h1",{className:"text-3xl font-bold",style:{color:"var(--color-text-primary)"},children:"Orders Management"}),e.jsx("p",{className:"mt-4",style:{color:"var(--color-text-light)"},children:"Manage all customer orders and track shipments"}),e.jsx(c,{})]})});export{n as default};
